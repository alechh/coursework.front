{"version":3,"sources":["Kladr.js"],"names":["Kladr","props","setState","opened","value","onChange","state","render","empty","isEmpty","change","validation","error","color","Colors","ERROR","marginBottom","warning","WARNING","_renderAddress","address","_handleOpen","_renderModal","place","util","placeName","index","region","district","city","settlement","street","house","building","room","filter","x","join","title","_handleChange","_handleClose","React","Component","PropTypes","string","any","func","Object","keys","key"],"mappings":"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","sourcesContent":["// @flow\r\n/* eslint-disable flowtype/no-weak-types */\r\nimport * as React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport EditIcon from '@skbkontur/react-icons/Edit';\r\nimport warning from 'warning';\r\nimport AddressModal from './AddressModal';\r\nimport Colors from '../../lib/Colors';\r\nimport Link from '../Link';\r\nimport type { Address } from './Types';\r\nimport * as util from './util';\r\n\r\ntype Props = {\r\n  error?: ?string,\r\n  title: string,\r\n  value: any,\r\n  warning?: ?string,\r\n  onChange: any,\r\n};\r\n\r\ntype State = {\r\n  opened: boolean,\r\n};\r\n\r\n/**\r\n * @deprecated Компонент устарел и, вероятно, будет удален в версии 2.0.0. Рассмотрите возможность перехода на [Fias](#/Components/Fias).\r\n */\r\nexport default class Kladr extends React.Component<Props, State> {\r\n  static __KONTUR_REACT_UI__ = 'Kladr';\r\n\r\n  static propTypes = {\r\n    error: PropTypes.string,\r\n    title: PropTypes.string,\r\n    value: PropTypes.any,\r\n    warning: PropTypes.string,\r\n    onChange: PropTypes.func,\r\n  };\r\n\r\n  constructor(props: any) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      opened: false,\r\n    };\r\n\r\n    warning(false, 'Kladr is deprecated and will be removed in v2.0.0. Please, consider to move on Fias instead.');\r\n  }\r\n\r\n  render() {\r\n    const value = this.props.value || {};\r\n    const empty = isEmpty(value);\r\n    const change = empty ? 'Заполнить адрес' : 'Изменить адрес';\r\n\r\n    let validation = null;\r\n    if (this.props.error) {\r\n      validation = <div style={{ color: Colors.ERROR, marginBottom: 5 }}>{this.props.error}</div>;\r\n    } else if (this.props.warning) {\r\n      validation = <div style={{ color: Colors.WARNING, marginBottom: 5 }}>{this.props.warning}</div>;\r\n    }\r\n\r\n    return (\r\n      <span>\r\n        {!empty && <div style={{ marginBottom: 5 }}>{this._renderAddress(value.address)}</div>}\r\n        {validation}\r\n        <Link icon={<EditIcon />} onClick={this._handleOpen}>\r\n          {change}\r\n        </Link>\r\n        {this.state.opened && this._renderModal()}\r\n      </span>\r\n    );\r\n  }\r\n\r\n  _renderAddress(address: ?Address) {\r\n    if (!address) {\r\n      return null;\r\n    }\r\n\r\n    const place = place => place && util.placeName(place);\r\n    return [\r\n      address.index,\r\n      place(address.region),\r\n      place(address.district),\r\n      place(address.city),\r\n      place(address.settlement),\r\n      place(address.street),\r\n      address.house && `дом ${address.house}`,\r\n      address.building && `корпус ${address.building}`,\r\n      address.room && `квартира ${address.room}`,\r\n    ]\r\n      .filter(x => !!x)\r\n      .join(', ');\r\n  }\r\n\r\n  _renderModal() {\r\n    return (\r\n      <AddressModal\r\n        address={this.props.value && this.props.value.address}\r\n        title={this.props.title}\r\n        onChange={this._handleChange}\r\n        onClose={this._handleClose}\r\n      />\r\n    );\r\n  }\r\n\r\n  _handleOpen = () => {\r\n    this.setState({ opened: true });\r\n  };\r\n\r\n  _handleChange = (value: { address: Address }) => {\r\n    const onChange = this.props.onChange;\r\n    onChange && onChange(null, value);\r\n  };\r\n\r\n  _handleClose = () => {\r\n    this.setState({ opened: false });\r\n  };\r\n}\r\n\r\nfunction isEmpty(value) {\r\n  const address = value.address;\r\n  if (address) {\r\n    for (const key of Object.keys(address)) {\r\n      if (address[key]) {\r\n        return false;\r\n      }\r\n    }\r\n  }\r\n\r\n  return true;\r\n}\r\n"]}