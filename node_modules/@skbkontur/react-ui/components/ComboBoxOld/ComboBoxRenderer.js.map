{"version":3,"sources":["ComboBoxRenderer.js"],"names":["INPUT_PASS_PROPS","borderless","error","warning","width","disabled","onMouseEnter","onMouseLeave","onMouseOver","ComboBoxRenderer","element","props","context","el","_focusable","focus","ReactDOM","findDOMNode","menu","_menu","event","value","newInputValue","inputValueChanged","state","searchText","onInputChange","nextState","setState","opened","_debouncedFetchList","_ignoreRecover","onInputKeyDown","defaultPrevented","key","preventDefault","safelyCall","onOpen","up","down","handled","enter","_tryRecover","_handleBlur","_close","_setCurrentSearchText","info","_fetchList","_handleFocus","_handleValueClick","_ignoreBlur","isEditing","onFocus","onAlkoFocus","onBlur","onAlkoBlur","e","endEdit","result","setTimeout","onClose","pattern","expectingId","_fetchingId","source","then","_mounted","reset","setSelectionRange","length","selected","debounceInterval","render","_handleClickOutside","styles","root","renderInput","renderValue","renderMenu","openButton","arrow","_handleArrowClick","_handleArrowMouseDown","inputProps","input","_refFocusable","_handleInputChange","_handleInputKey","placeholder","isNotRecovered","_error","isEmptyResults","values","menuAlign","disablePortal","_refMenu","renderEmptyResults","renderResults","renderTotalCount","mapResult","i","React","isValidElement","cloneElement","onClick","_handleItemClick","renderItem","renderNotFound","isFunction","total","totalCount","componentDidMount","autoFocus","_focus","componentWillUnmount","options","_change","recover","recovered","_setError","_lastError","onError","onChange","target","valueToString","Component","children","fn","args","map","infos"],"mappings":"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","sourcesContent":["// @flow\r\n/* eslint-disable flowtype/no-weak-types */\r\nimport * as React from 'react';\r\nimport ReactDOM from 'react-dom';\r\n\r\nimport filterProps from '../filterProps';\r\n\r\nimport debounce from 'lodash.debounce';\r\n\r\nimport RenderLayer from '../RenderLayer';\r\nimport DropdownContainer from '../DropdownContainer/DropdownContainer';\r\nimport Input from '../Input';\r\nimport InputLikeText from '../internal/InputLikeText/InputLikeText';\r\nimport Menu from '../Menu/Menu';\r\nimport MenuItem from '../MenuItem/MenuItem';\r\nimport type { MenuItemState } from '../MenuItem/MenuItem';\r\nimport { fixClickFocusIE } from '../../lib/events/fixClickFocusIE';\r\n\r\nimport styles from './ComboBoxRenderer.module.less';\r\n\r\nconst INPUT_PASS_PROPS = {\r\n  borderless: true,\r\n  error: true,\r\n  warning: true,\r\n  width: true,\r\n  disabled: true,\r\n  onMouseEnter: true,\r\n  onMouseLeave: true,\r\n  onMouseOver: true,\r\n};\r\n\r\nexport type Value = any;\r\nexport type Info = any;\r\n\r\ntype SourceResult = {\r\n  values: Array<Value | React.Element<any> | (() => React.Element<any>)>,\r\n  infos?: Array<Info>,\r\n  total?: number,\r\n};\r\n\r\ntype RecoverResult = {\r\n  value: Value,\r\n  info?: Info,\r\n};\r\n\r\ntype ErrorKind = null | 'not_recovered';\r\n\r\ntype RecoverFunc = (searchString: string) => RecoverResult;\r\n\r\nexport type BaseProps = {\r\n  autoFocus?: boolean,\r\n  borderless?: boolean,\r\n  disabled?: boolean,\r\n  error?: boolean,\r\n  info?: Info | ((v: Value) => Promise<Info>),\r\n  menuAlign: 'left' | 'right',\r\n  disablePortal?: boolean,\r\n  debounceInterval?: number,\r\n  openButton?: boolean,\r\n  placeholder: string,\r\n  recover?: RecoverFunc | boolean,\r\n  renderItem: (value: Value, info: Info, state: MenuItemState) => React.Node,\r\n  renderValue: (value: Value, info: ?Info) => React.Element<any>,\r\n  renderNotFound?: string | ((searchText: string) => React.Element<any> | string),\r\n  renderTotalCount?: (f: number, total: number) => React.Element<any> | string,\r\n  source: (searchText: string) => Promise<SourceResult>,\r\n  warning?: boolean,\r\n  value: Value | null,\r\n  valueToString?: (value: Value, info: ?Info) => string,\r\n  width: number | string,\r\n\r\n  onBlur?: () => void,\r\n  onChange?: (event: { target: { value: Value } }, value: Value) => void,\r\n  onClose?: () => void,\r\n  onError?: (kind: ErrorKind) => void,\r\n  onFocus?: () => void,\r\n  onOpen?: () => void,\r\n  onInputChange?: (value: string) => ?string,\r\n  onInputKeyDown?: (e: SyntheticKeyboardEvent<>) => void,\r\n\r\n  alkoValueToText?: (value: Value) => string,\r\n  onAlkoFocus?: () => void,\r\n  onAlkoBlur?: () => void,\r\n\r\n  onMouseEnter?: (e: SyntheticMouseEvent<>) => void,\r\n  onMouseLeave?: (e: SyntheticMouseEvent<>) => void,\r\n  onMouseOver?: (e: SyntheticMouseEvent<>) => void,\r\n};\r\n\r\ntype Props = BaseProps & {\r\n  info: Info,\r\n};\r\n\r\ntype State = {\r\n  opened: boolean,\r\n  searchText: string,\r\n  isEditing: boolean,\r\n  result: ?SourceResult,\r\n  selected: number,\r\n};\r\n\r\nclass ComboBoxRenderer extends React.Component<Props, State> {\r\n  // eslint-disable-next-line react/no-multi-comp\r\n  static Item = class Item extends React.Component<{ children?: React.Node }> {\r\n    render() {\r\n      return <MenuItem>{this.props.children}</MenuItem>;\r\n    }\r\n  };\r\n\r\n  static static(element: (() => React.Element<any>) | React.Element<any>) {\r\n    return element;\r\n  }\r\n\r\n  static defaultProps = {\r\n    renderItem,\r\n    renderValue,\r\n    placeholder: '',\r\n    width: (250: number | string),\r\n    menuAlign: 'left',\r\n    debounceInterval: 0,\r\n  };\r\n\r\n  _mounted = false;\r\n  _focusable = null;\r\n  _menu: ?Menu = null;\r\n  _focusSubscribtion: ?{ remove: () => void } = null;\r\n  _lastError: ErrorKind = null;\r\n  _error: ErrorKind = null;\r\n  _ignoreRecover = true;\r\n  _ignoreBlur = true;\r\n  _fetchingId = 0;\r\n  _debouncedFetchList: Function;\r\n\r\n  constructor(props: Props, context: mixed) {\r\n    super(props, context);\r\n\r\n    this.state = {\r\n      opened: false,\r\n      searchText: '',\r\n      result: null,\r\n      isEditing: false,\r\n      selected: -1,\r\n    };\r\n\r\n    const { debounceInterval } = this.props;\r\n    this._debouncedFetchList =\r\n      debounceInterval && debounceInterval > 0 ? debounce(this._fetchList, debounceInterval) : this._fetchList;\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <RenderLayer\r\n        onFocusOutside={this._handleBlur}\r\n        onClickOutside={this._handleClickOutside}\r\n        active={this.state.opened}\r\n      >\r\n        <label className={styles.root} style={{ width: this.props.width }}>\r\n          {this.state.isEditing ? this.renderInput() : this.renderValue()}\r\n          {this.state.opened && this.renderMenu()}\r\n          {this.props.openButton && (\r\n            <div className={styles.arrow} onClick={this._handleArrowClick} onMouseDown={this._handleArrowMouseDown} />\r\n          )}\r\n        </label>\r\n      </RenderLayer>\r\n    );\r\n  }\r\n\r\n  renderInput() {\r\n    const inputProps = filterProps(this.props, INPUT_PASS_PROPS);\r\n    return (\r\n      <div className={styles.input}>\r\n        <Input\r\n          ref={this._refFocusable}\r\n          {...inputProps}\r\n          value={this.state.searchText}\r\n          rightIcon={this.props.openButton && <span />}\r\n          onChange={this._handleInputChange}\r\n          onKeyDown={this._handleInputKey}\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  renderValue() {\r\n    const inputProps = filterProps(this.props, INPUT_PASS_PROPS);\r\n\r\n    const value = this.props.value ? (\r\n      this.props.renderValue(this.props.value, this.props.info)\r\n    ) : (\r\n      <span className={styles.placeholder}>{this.props.placeholder}</span>\r\n    );\r\n\r\n    const isNotRecovered = !!this._error;\r\n\r\n    return (\r\n      <InputLikeText\r\n        ref={this._refFocusable}\r\n        {...inputProps}\r\n        onClick={this._handleValueClick}\r\n        onFocus={this._handleValueClick}\r\n        error={isNotRecovered || this.props.error}\r\n      >\r\n        {isNotRecovered ? this.state.searchText : value}\r\n      </InputLikeText>\r\n    );\r\n  }\r\n\r\n  renderMenu() {\r\n    const { result } = this.state;\r\n    if (!result) {\r\n      return null;\r\n    }\r\n\r\n    const isEmptyResults = result.values.length === 0;\r\n\r\n    return (\r\n      <DropdownContainer\r\n        getParent={() => ReactDOM.findDOMNode(this)}\r\n        align={this.props.menuAlign}\r\n        disablePortal={this.props.disablePortal}\r\n        offsetY={1}\r\n      >\r\n        <Menu ref={this._refMenu} maxHeight={200}>\r\n          {isEmptyResults ? this.renderEmptyResults() : this.renderResults(result)}\r\n          {this.renderTotalCount(result)}\r\n        </Menu>\r\n      </DropdownContainer>\r\n    );\r\n  }\r\n\r\n  renderResults(result: SourceResult): Array<?React.Element<Class<MenuItem>>> {\r\n    return mapResult(result, (value, info, i) => {\r\n      if (typeof value === 'function' || React.isValidElement(value)) {\r\n        const element = typeof value === 'function' ? value() : value;\r\n        return React.cloneElement(element, {\r\n          key: i,\r\n          onClick: event => this._handleItemClick(event, element.props),\r\n        });\r\n      }\r\n      return (\r\n        <MenuItem\r\n          key={i}\r\n          onClick={(event: SyntheticEvent<*>) => {\r\n            this._handleItemClick(event, { value, info });\r\n          }}\r\n        >\r\n          {state => this.props.renderItem(value, info, state)}\r\n        </MenuItem>\r\n      );\r\n    });\r\n  }\r\n\r\n  renderEmptyResults(): ?React.Element<typeof MenuItem> {\r\n    const { renderNotFound } = this.props;\r\n\r\n    if (!renderNotFound) {\r\n      return null;\r\n    }\r\n\r\n    const { searchText } = this.state;\r\n\r\n    return (\r\n      <MenuItem disabled={!isFunction(renderNotFound)}>\r\n        {isFunction(renderNotFound) ? renderNotFound(searchText) : renderNotFound}\r\n      </MenuItem>\r\n    );\r\n  }\r\n\r\n  renderTotalCount(result: SourceResult) {\r\n    const { renderTotalCount } = this.props;\r\n\r\n    if (!renderTotalCount || !result || !result.values || !result.total) {\r\n      return null;\r\n    }\r\n\r\n    if (result.values.length === result.total) {\r\n      return null;\r\n    }\r\n\r\n    return (\r\n      <MenuItem disabled>\r\n        <div className={styles.totalCount}>{renderTotalCount(result.values.length, result.total)}</div>\r\n      </MenuItem>\r\n    );\r\n  }\r\n\r\n  componentDidMount() {\r\n    this._mounted = true;\r\n    if (this.props.autoFocus) {\r\n      this._focus();\r\n    }\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this._mounted = false;\r\n  }\r\n\r\n  _refFocusable = (el: Input | InputLikeText | null) => {\r\n    this._focusable = el && (el.focus ? el : (ReactDOM.findDOMNode(el): any));\r\n  };\r\n\r\n  _refMenu = (menu: ?Menu) => {\r\n    this._menu = menu;\r\n  };\r\n\r\n  _handleInputChange = (event: SyntheticInputEvent<HTMLInputElement>, value: string) => {\r\n    let newInputValue = value;\r\n\r\n    const inputValueChanged = this.state.searchText !== newInputValue;\r\n    if (inputValueChanged && this.props.onInputChange) {\r\n      let nextState = this.props.onInputChange(newInputValue);\r\n\r\n      if (nextState != null && typeof nextState !== 'object') {\r\n        newInputValue = '' + nextState;\r\n      }\r\n    }\r\n\r\n    this.setState(() => ({\r\n      searchText: newInputValue,\r\n      opened: true,\r\n    }));\r\n    this._debouncedFetchList(newInputValue);\r\n    this._ignoreRecover = false;\r\n  };\r\n\r\n  _handleInputKey = (event: SyntheticKeyboardEvent<>) => {\r\n    if (typeof this.props.onInputKeyDown === 'function') {\r\n      this.props.onInputKeyDown(event);\r\n      if (event.defaultPrevented) {\r\n        return;\r\n      }\r\n    }\r\n\r\n    switch (event.key) {\r\n      case 'ArrowUp':\r\n        event.preventDefault();\r\n\r\n        if (!this.state.opened) {\r\n          this.setState({ opened: true });\r\n          safelyCall(this.props.onOpen);\r\n        }\r\n\r\n        this._menu && this._menu.up();\r\n        break;\r\n      case 'ArrowDown':\r\n        event.preventDefault();\r\n\r\n        if (!this.state.opened) {\r\n          this.setState({ opened: true });\r\n          safelyCall(this.props.onOpen);\r\n        }\r\n\r\n        this._menu && this._menu.down();\r\n        break;\r\n      case 'Enter':\r\n        event.preventDefault();\r\n        const handled = this._menu && this._menu.enter(event);\r\n        if (!handled) {\r\n          this._tryRecover();\r\n\r\n          // Close ComboBox only if Enter wasn't handled by the Menu.\r\n          this._handleBlur();\r\n        }\r\n        break;\r\n      case 'Escape':\r\n        event.preventDefault();\r\n        if (!this.state.opened) {\r\n          return;\r\n        }\r\n        this._close();\r\n        break;\r\n    }\r\n  };\r\n\r\n  _handleValueClick = () => {\r\n    this._setCurrentSearchText(this.props.value, this.props.info);\r\n    this._fetchList('');\r\n    this._handleFocus();\r\n  };\r\n\r\n  _handleItemClick(event: SyntheticEvent<*>, options: { value?: Value, info?: Info, onClick?: () => void }) {\r\n    this.setState({ searchText: '', opened: false, isEditing: false });\r\n    this._change(options.value, options.info);\r\n\r\n    safelyCall(options.onClick);\r\n    this._handleBlur();\r\n  }\r\n\r\n  _handleArrowMouseDown = (event: SyntheticMouseEvent<>) => {\r\n    event.preventDefault();\r\n  };\r\n\r\n  _handleArrowClick = (event: SyntheticMouseEvent<>) => {\r\n    if (!this.state.opened && !this.props.disabled) {\r\n      this._handleValueClick();\r\n    }\r\n  };\r\n\r\n  _handleFocus = () => {\r\n    /* Allow blur happen only if focus occured */\r\n    this._ignoreBlur = false;\r\n\r\n    this.setState({ isEditing: true, opened: true });\r\n    safelyCall(this.props.onOpen);\r\n\r\n    if (!safelyCall(this.props.onFocus)) {\r\n      safelyCall(this.props.onAlkoFocus);\r\n    }\r\n  };\r\n\r\n  _handleBlur = () => {\r\n    if (this._ignoreBlur) {\r\n      return;\r\n    }\r\n\r\n    this._close(true);\r\n    this._tryRecover();\r\n\r\n    if (!safelyCall(this.props.onBlur)) {\r\n      safelyCall(this.props.onAlkoBlur);\r\n    }\r\n\r\n    /* Blur should occure only once */\r\n    this._ignoreBlur = true;\r\n  };\r\n\r\n  _handleClickOutside = (e: Event) => {\r\n    fixClickFocusIE(e);\r\n    this._handleBlur();\r\n  };\r\n\r\n  _close = (endEdit?: boolean) => {\r\n    this.setState({ opened: false, result: null });\r\n    setTimeout(() => this.setState({ isEditing: !endEdit }), 0);\r\n    safelyCall(this.props.onClose);\r\n  };\r\n\r\n  _fetchList = (pattern: string) => {\r\n    const expectingId = ++this._fetchingId;\r\n    this.props.source(pattern).then(result => {\r\n      if (!this._mounted) {\r\n        return;\r\n      }\r\n\r\n      if (expectingId === this._fetchingId && this.state.opened) {\r\n        this._menu && this._menu.reset();\r\n        this.setState(() => ({ result }));\r\n      }\r\n    });\r\n  };\r\n\r\n  _focus = () => {\r\n    if (this._focusable && this._focusable.setSelectionRange) {\r\n      // $FlowIgnore\r\n      this._focusable.setSelectionRange(0, this.state.searchText.length);\r\n    } else if (this._focusable) {\r\n      this._focusable.focus();\r\n    }\r\n  };\r\n\r\n  _tryRecover() {\r\n    if (this._ignoreRecover) {\r\n      return;\r\n    }\r\n    this._ignoreRecover = true;\r\n\r\n    if (!this.props.recover) {\r\n      this._change(null);\r\n      this.setState({ searchText: '' });\r\n      return;\r\n    }\r\n\r\n    const searchText = this.state.searchText;\r\n    let recovered: ?RecoverResult = null;\r\n\r\n    if (typeof this.props.recover === 'function') {\r\n      recovered = this.props.recover(searchText);\r\n    } else if (this.props.recover === true) {\r\n      recovered = { value: searchText };\r\n    }\r\n\r\n    if (recovered) {\r\n      this._change(recovered.value, recovered.info);\r\n    } else {\r\n      this._change(null);\r\n      this._setError(this.state.searchText ? 'not_recovered' : null);\r\n    }\r\n  }\r\n\r\n  _setError(error: ErrorKind) {\r\n    this._error = error;\r\n    if (this._lastError !== error) {\r\n      this._lastError = error;\r\n      safelyCall(this.props.onError, error);\r\n    }\r\n  }\r\n\r\n  _change(value: Value, info?: Info) {\r\n    safelyCall(this.props.onChange, { target: { value } }, value, info);\r\n    this._setError(null);\r\n\r\n    /* No need in recovers after value changes */\r\n    this._ignoreRecover = true;\r\n  }\r\n\r\n  _setCurrentSearchText(value: Value, info: ?Info) {\r\n    const valueToString = this.props.valueToString;\r\n\r\n    if (valueToString) {\r\n      const searchText = value ? valueToString(value, info) : this.state.searchText;\r\n\r\n      return this.setState({ searchText }, this._focus);\r\n    }\r\n\r\n    return this.setState({ searchText: '' }, this._focus);\r\n  }\r\n}\r\n\r\nfunction safelyCall(fn: ?Function, ...args: any[]) {\r\n  if (fn) {\r\n    fn(...args);\r\n    return true;\r\n  }\r\n  return false;\r\n}\r\n\r\nfunction mapResult(result: SourceResult, fn: (v: Value, d: Info, i: number) => any): Array<any> {\r\n  return result.values.map((value, i) => {\r\n    const info = result.infos && result.infos[i];\r\n    return fn(value, info, i);\r\n  });\r\n}\r\n\r\nfunction renderValue(value: *, info: *) {\r\n  return info;\r\n}\r\n\r\nfunction renderItem(value: *, info: *, state: *) {\r\n  return info;\r\n}\r\n\r\nfunction isFunction(fn) /*: boolean %checks */ {\r\n  return typeof fn === 'function';\r\n}\r\n\r\nexport default ComboBoxRenderer;\r\n"]}