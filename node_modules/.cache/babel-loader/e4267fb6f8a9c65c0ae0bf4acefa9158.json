{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar tslib_1 = require(\"tslib\");\n\nvar React = tslib_1.__importStar(require(\"react\"));\n\nvar PropTypes = tslib_1.__importStar(require(\"prop-types\"));\n\nvar LayoutEvents_1 = tslib_1.__importDefault(require(\"../../lib/LayoutEvents\"));\n\nvar Sticky_module_less_1 = tslib_1.__importDefault(require(\"./Sticky.module.css\"));\n\nvar utils_1 = require(\"../../lib/utils\");\n\nvar Emotion_1 = require(\"../../lib/theming/Emotion\");\n\nvar warning_1 = tslib_1.__importDefault(require(\"warning\"));\n\nvar shallowEqual_1 = tslib_1.__importDefault(require(\"fbjs/lib/shallowEqual\"));\n\nvar ZIndex_1 = tslib_1.__importDefault(require(\"../ZIndex\"));\n\nvar MAX_REFLOW_RETRIES = 5;\n\nvar Sticky =\n/** @class */\nfunction (_super) {\n  tslib_1.__extends(Sticky, _super);\n\n  function Sticky() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.state = {\n      fixed: false,\n      deltaHeight: 0,\n      stopped: false,\n      relativeTop: 0\n    };\n    _this.layoutSubscription = {\n      remove: null\n    };\n    _this.reflowCounter = 0;\n\n    _this.refWrapper = function (ref) {\n      return _this.wrapper = ref;\n    };\n\n    _this.refInner = function (ref) {\n      return _this.inner = ref;\n    };\n\n    _this.reflow = function () {\n      var documentElement = document.documentElement;\n\n      if (!documentElement) {\n        throw Error('There is no \"documentElement\" in document');\n      }\n\n      var windowHeight = window.innerHeight || documentElement.clientHeight;\n\n      if (!_this.wrapper || !_this.inner) {\n        return;\n      }\n\n      var _a = _this.wrapper.getBoundingClientRect(),\n          top = _a.top,\n          bottom = _a.bottom,\n          left = _a.left;\n\n      var _b = _this.inner.getBoundingClientRect(),\n          width = _b.width,\n          height = _b.height;\n\n      var _c = _this.props,\n          offset = _c.offset,\n          getStop = _c.getStop,\n          side = _c.side;\n      var _d = _this.state,\n          prevFixed = _d.fixed,\n          _e = _d.height,\n          prevHeight = _e === void 0 ? height : _e;\n      var fixed = side === 'top' ? top < offset : bottom > windowHeight - offset;\n\n      _this.setState({\n        fixed: fixed,\n        left: left\n      });\n\n      if (fixed && !prevFixed) {\n        _this.setState({\n          width: width,\n          height: height\n        });\n      }\n\n      if (fixed) {\n        var stop_1 = getStop && getStop();\n\n        if (stop_1) {\n          var deltaHeight = prevHeight - height;\n          var stopRect = stop_1.getBoundingClientRect();\n          var outerHeight_1 = height + offset;\n          var stopped = false;\n          var relativeTop = 0;\n\n          if (side === 'top') {\n            stopped = stopRect.top - outerHeight_1 < 0;\n            relativeTop = stopRect.top - height - top;\n          } else {\n            stopped = stopRect.bottom + outerHeight_1 > windowHeight;\n            relativeTop = stopRect.bottom - top;\n          }\n\n          _this.setState({\n            relativeTop: relativeTop,\n            deltaHeight: deltaHeight,\n            stopped: stopped\n          });\n        }\n      }\n    };\n\n    return _this;\n  }\n\n  Sticky.prototype.componentDidMount = function () {\n    warning_1[\"default\"](this.props.allowChildWithMargins === undefined, '\"allowChildWithMargins\" prop is deprecated. Component \"Sticky\" work correctly without it.');\n    this.reflow();\n    this.layoutSubscription = LayoutEvents_1[\"default\"].addListener(this.reflow);\n  };\n\n  Sticky.prototype.componentWillUnmount = function () {\n    if (this.layoutSubscription.remove) {\n      this.layoutSubscription.remove();\n    }\n  };\n\n  Sticky.prototype.componentDidUpdate = function (prevProps, prevState) {\n    if (!shallowEqual_1[\"default\"](prevProps, this.props) || !shallowEqual_1[\"default\"](prevState, this.state)) {\n      if (this.reflowCounter < MAX_REFLOW_RETRIES) {\n        LayoutEvents_1[\"default\"].emit();\n        this.reflowCounter += 1;\n        return;\n      }\n    }\n\n    this.reflowCounter = 0;\n  };\n\n  Sticky.prototype.render = function () {\n    var _a;\n\n    var children = this.props.children;\n    var _b = this.props,\n        side = _b.side,\n        offset = _b.offset;\n    var _c = this.state,\n        fixed = _c.fixed,\n        stopped = _c.stopped,\n        relativeTop = _c.relativeTop,\n        deltaHeight = _c.deltaHeight,\n        width = _c.width,\n        height = _c.height,\n        left = _c.left;\n    var innerStyle = {};\n\n    if (fixed) {\n      if (stopped) {\n        innerStyle.top = relativeTop;\n        innerStyle[side === 'top' ? 'marginTop' : 'marginBottom'] = deltaHeight;\n      } else {\n        innerStyle.width = width;\n        innerStyle[side] = offset;\n        innerStyle.left = left;\n      }\n    }\n\n    if (utils_1.isFunction(children)) {\n      children = children(fixed);\n    }\n\n    return React.createElement(\"div\", {\n      ref: this.refWrapper\n    }, React.createElement(ZIndex_1[\"default\"], {\n      priority: \"Sticky\",\n      applyZIndex: fixed,\n      className: Emotion_1.cx(Sticky_module_less_1[\"default\"].inner, (_a = {}, _a[Sticky_module_less_1[\"default\"].fixed] = fixed, _a[Sticky_module_less_1[\"default\"].stopped] = stopped, _a)),\n      style: innerStyle,\n      wrapperRef: this.refInner\n    }, React.createElement(\"div\", {\n      className: Emotion_1.cx(Sticky_module_less_1[\"default\"].container)\n    }, children)), fixed && !stopped ? React.createElement(\"div\", {\n      style: {\n        width: width,\n        height: height\n      }\n    }) : null);\n  };\n\n  Sticky.__KONTUR_REACT_UI__ = 'Sticky';\n  Sticky.propTypes = {\n    children: PropTypes.oneOfType([PropTypes.node, PropTypes.func]),\n\n    /**\r\n                                                                      * Функция, которая возвращает DOM-элемент, который нельзя пересекать.\r\n                                                                      */\n    getStop: PropTypes.func,\n\n    /**\r\n                              * Отступ от границы в пикселях\r\n                              */\n    offset: PropTypes.number,\n    side: PropTypes.oneOf(['top', 'bottom']).isRequired,\n    allowChildWithMargins: PropTypes.bool\n  };\n  Sticky.defaultProps = {\n    offset: 0\n  };\n  return Sticky;\n}(React.Component);\n\nexports[\"default\"] = Sticky;","map":{"version":3,"sources":["/home/aleksandr/hwproj.courseworks.front/node_modules/@skbkontur/react-ui/components/Sticky/Sticky.js"],"names":["Object","defineProperty","exports","value","tslib_1","require","React","__importStar","PropTypes","LayoutEvents_1","__importDefault","Sticky_module_less_1","utils_1","Emotion_1","warning_1","shallowEqual_1","ZIndex_1","MAX_REFLOW_RETRIES","Sticky","_super","__extends","_this","apply","arguments","state","fixed","deltaHeight","stopped","relativeTop","layoutSubscription","remove","reflowCounter","refWrapper","ref","wrapper","refInner","inner","reflow","documentElement","document","Error","windowHeight","window","innerHeight","clientHeight","_a","getBoundingClientRect","top","bottom","left","_b","width","height","_c","props","offset","getStop","side","_d","prevFixed","_e","prevHeight","setState","stop_1","stopRect","outerHeight_1","prototype","componentDidMount","allowChildWithMargins","undefined","addListener","componentWillUnmount","componentDidUpdate","prevProps","prevState","emit","render","children","innerStyle","isFunction","createElement","priority","applyZIndex","className","cx","style","wrapperRef","container","__KONTUR_REACT_UI__","propTypes","oneOfType","node","func","number","oneOf","isRequired","bool","defaultProps","Component"],"mappings":"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","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar tslib_1 = require(\"tslib\");\nvar React = tslib_1.__importStar(require(\"react\"));\nvar PropTypes = tslib_1.__importStar(require(\"prop-types\"));\nvar LayoutEvents_1 = tslib_1.__importDefault(require(\"../../lib/LayoutEvents\"));\nvar Sticky_module_less_1 = tslib_1.__importDefault(require(\"./Sticky.module.css\"));\nvar utils_1 = require(\"../../lib/utils\");\nvar Emotion_1 = require(\"../../lib/theming/Emotion\");\nvar warning_1 = tslib_1.__importDefault(require(\"warning\"));\nvar shallowEqual_1 = tslib_1.__importDefault(require(\"fbjs/lib/shallowEqual\"));\nvar ZIndex_1 = tslib_1.__importDefault(require(\"../ZIndex\"));\nvar MAX_REFLOW_RETRIES = 5;\nvar Sticky = /** @class */function (_super) {\n  tslib_1.__extends(Sticky, _super);\n  function Sticky() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n    _this.state = {\n      fixed: false,\n      deltaHeight: 0,\n      stopped: false,\n      relativeTop: 0 };\n\n    _this.layoutSubscription = { remove: null };\n    _this.reflowCounter = 0;\n    _this.refWrapper = function (ref) {return _this.wrapper = ref;};\n    _this.refInner = function (ref) {return _this.inner = ref;};\n    _this.reflow = function () {\n      var documentElement = document.documentElement;\n      if (!documentElement) {\n        throw Error('There is no \"documentElement\" in document');\n      }\n      var windowHeight = window.innerHeight || documentElement.clientHeight;\n      if (!_this.wrapper || !_this.inner) {\n        return;\n      }\n      var _a = _this.wrapper.getBoundingClientRect(),top = _a.top,bottom = _a.bottom,left = _a.left;\n      var _b = _this.inner.getBoundingClientRect(),width = _b.width,height = _b.height;\n      var _c = _this.props,offset = _c.offset,getStop = _c.getStop,side = _c.side;\n      var _d = _this.state,prevFixed = _d.fixed,_e = _d.height,prevHeight = _e === void 0 ? height : _e;\n      var fixed = side === 'top' ? top < offset : bottom > windowHeight - offset;\n      _this.setState({ fixed: fixed, left: left });\n      if (fixed && !prevFixed) {\n        _this.setState({ width: width, height: height });\n      }\n      if (fixed) {\n        var stop_1 = getStop && getStop();\n        if (stop_1) {\n          var deltaHeight = prevHeight - height;\n          var stopRect = stop_1.getBoundingClientRect();\n          var outerHeight_1 = height + offset;\n          var stopped = false;\n          var relativeTop = 0;\n          if (side === 'top') {\n            stopped = stopRect.top - outerHeight_1 < 0;\n            relativeTop = stopRect.top - height - top;\n          } else\n          {\n            stopped = stopRect.bottom + outerHeight_1 > windowHeight;\n            relativeTop = stopRect.bottom - top;\n          }\n          _this.setState({ relativeTop: relativeTop, deltaHeight: deltaHeight, stopped: stopped });\n        }\n      }\n    };\n    return _this;\n  }\n  Sticky.prototype.componentDidMount = function () {\n    warning_1[\"default\"](this.props.allowChildWithMargins === undefined, '\"allowChildWithMargins\" prop is deprecated. Component \"Sticky\" work correctly without it.');\n    this.reflow();\n    this.layoutSubscription = LayoutEvents_1[\"default\"].addListener(this.reflow);\n  };\n  Sticky.prototype.componentWillUnmount = function () {\n    if (this.layoutSubscription.remove) {\n      this.layoutSubscription.remove();\n    }\n  };\n  Sticky.prototype.componentDidUpdate = function (prevProps, prevState) {\n    if (!shallowEqual_1[\"default\"](prevProps, this.props) || !shallowEqual_1[\"default\"](prevState, this.state)) {\n      if (this.reflowCounter < MAX_REFLOW_RETRIES) {\n        LayoutEvents_1[\"default\"].emit();\n        this.reflowCounter += 1;\n        return;\n      }\n    }\n    this.reflowCounter = 0;\n  };\n  Sticky.prototype.render = function () {\n    var _a;\n    var children = this.props.children;\n    var _b = this.props,side = _b.side,offset = _b.offset;\n    var _c = this.state,fixed = _c.fixed,stopped = _c.stopped,relativeTop = _c.relativeTop,deltaHeight = _c.deltaHeight,width = _c.width,height = _c.height,left = _c.left;\n    var innerStyle = {};\n    if (fixed) {\n      if (stopped) {\n        innerStyle.top = relativeTop;\n        innerStyle[side === 'top' ? 'marginTop' : 'marginBottom'] = deltaHeight;\n      } else\n      {\n        innerStyle.width = width;\n        innerStyle[side] = offset;\n        innerStyle.left = left;\n      }\n    }\n    if (utils_1.isFunction(children)) {\n      children = children(fixed);\n    }\n    return React.createElement(\"div\", { ref: this.refWrapper },\n    React.createElement(ZIndex_1[\"default\"], { priority: \"Sticky\", applyZIndex: fixed, className: Emotion_1.cx(Sticky_module_less_1[\"default\"].inner, (_a = {},\n      _a[Sticky_module_less_1[\"default\"].fixed] = fixed,\n      _a[Sticky_module_less_1[\"default\"].stopped] = stopped,\n      _a)), style: innerStyle, wrapperRef: this.refInner },\n    React.createElement(\"div\", { className: Emotion_1.cx(Sticky_module_less_1[\"default\"].container) }, children)),\n    fixed && !stopped ? React.createElement(\"div\", { style: { width: width, height: height } }) : null);\n  };\n  Sticky.__KONTUR_REACT_UI__ = 'Sticky';\n  Sticky.propTypes = {\n    children: PropTypes.oneOfType([PropTypes.node, PropTypes.func]),\n    /**\r\n                                                                      * Функция, которая возвращает DOM-элемент, который нельзя пересекать.\r\n                                                                      */\n    getStop: PropTypes.func,\n    /**\r\n                              * Отступ от границы в пикселях\r\n                              */\n    offset: PropTypes.number,\n    side: PropTypes.oneOf(['top', 'bottom']).isRequired,\n    allowChildWithMargins: PropTypes.bool };\n\n  Sticky.defaultProps = { offset: 0 };\n  return Sticky;\n}(React.Component);\nexports[\"default\"] = Sticky;"]},"metadata":{},"sourceType":"script"}