{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar tslib_1 = require(\"tslib\");\n\nvar React = tslib_1.__importStar(require(\"react\"));\n\nvar ReactDOM = tslib_1.__importStar(require(\"react-dom\"));\n\nvar react_focus_lock_1 = tslib_1.__importDefault(require(\"react-focus-lock\"));\n\nvar identifiers_1 = require(\"../../lib/events/keyboard/identifiers\");\n\nvar LayoutEvents_1 = tslib_1.__importDefault(require(\"../../lib/LayoutEvents\"));\n\nvar RenderContainer_1 = tslib_1.__importDefault(require(\"../RenderContainer/RenderContainer\"));\n\nvar ZIndex_1 = tslib_1.__importDefault(require(\"../ZIndex/ZIndex\"));\n\nvar stopPropagation_1 = tslib_1.__importDefault(require(\"../../lib/events/stopPropagation\"));\n\nvar HideBodyVerticalScroll_1 = tslib_1.__importDefault(require(\"../HideBodyVerticalScroll/HideBodyVerticalScroll\"));\n\nvar ModalStack_1 = tslib_1.__importDefault(require(\"../ModalStack\"));\n\nvar ModalContext_1 = require(\"./ModalContext\");\n\nvar ModalFooter_1 = require(\"./ModalFooter\");\n\nvar ModalHeader_1 = require(\"./ModalHeader\");\n\nvar ModalBody_1 = require(\"./ModalBody\");\n\nvar ModalClose_1 = tslib_1.__importDefault(require(\"./ModalClose\"));\n\nvar ResizeDetector_1 = tslib_1.__importDefault(require(\"../internal/ResizeDetector\"));\n\nvar ensureOldIEClassName_1 = require(\"../ensureOldIEClassName\");\n\nvar Modal_module_less_1 = tslib_1.__importDefault(require(\"./Modal.module.css\"));\n\nvar Emotion_1 = require(\"../../lib/theming/Emotion\");\n\nvar Modal_styles_1 = tslib_1.__importDefault(require(\"./Modal.styles\"));\n\nvar ThemeConsumer_1 = require(\"../ThemeConsumer\");\n\nvar helpers_1 = require(\"./helpers\");\n\nvar mountedModalsCount = 0;\n/**\r\n                             * Модальное окно\r\n                             *\r\n                             * Содержит в себе три компоненты: **Modal.Header**,\r\n                             * **Modal.Body** и **Modal.Footer**\r\n                             *\r\n                             * Для отображения серой плашки в футере в компонент\r\n                             * **Footer** необходимо передать пропс **panel**\r\n                             *\r\n                             * Для отключения прилипания шапки и футера\r\n                             * в соответствующий компонет нужно передать\r\n                             * проп **sticky** со значением **false**\r\n                             * (по-умолчанию прилипание включено)\r\n                             */\n\nvar Modal =\n/** @class */\nfunction (_super) {\n  tslib_1.__extends(Modal, _super);\n\n  function Modal() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.state = {\n      stackPosition: 0,\n      horizontalScroll: false\n    };\n    _this.stackSubscription = null;\n    _this.containerNode = null;\n    _this.mouseDownTarget = null;\n    _this.mouseUpTarget = null;\n\n    _this.requestClose = function () {\n      if (_this.props.disableClose) {\n        return;\n      }\n\n      if (_this.props.onClose) {\n        _this.props.onClose();\n      }\n    };\n\n    _this.refContainer = function (center) {\n      _this.containerNode = center;\n    };\n\n    _this.handleStackChange = function (stack) {\n      _this.setState({\n        stackPosition: stack.indexOf(_this)\n      });\n    };\n\n    _this.handleContainerMouseDown = function (event) {\n      _this.mouseDownTarget = event.target;\n    };\n\n    _this.handleContainerMouseUp = function (event) {\n      _this.mouseUpTarget = event.target;\n    };\n\n    _this.handleContainerClick = function (event) {\n      if (!_this.props.ignoreBackgroundClick) {\n        var target = event.target,\n            currentTarget = event.currentTarget;\n\n        if (target === currentTarget && _this.mouseDownTarget === currentTarget && _this.mouseUpTarget === currentTarget) {\n          _this.requestClose();\n        }\n      }\n    };\n\n    _this.handleKeyDown = function (e) {\n      if (_this.state.stackPosition !== 0) {\n        return;\n      }\n\n      if (identifiers_1.isKeyEscape(e)) {\n        stopPropagation_1[\"default\"](e);\n\n        _this.requestClose();\n      }\n    };\n\n    _this.checkHorizontalScrollAppearance = function () {\n      var hasScroll = false;\n\n      if (_this.containerNode) {\n        var containerClientWidth = _this.containerNode.clientWidth;\n        var containerScrollWidth = _this.containerNode.scrollWidth;\n        hasScroll = containerClientWidth < containerScrollWidth;\n      }\n\n      if (hasScroll && !_this.state.horizontalScroll) {\n        _this.setState({\n          horizontalScroll: true\n        });\n      } else if (_this.state.horizontalScroll) {\n        _this.setState({\n          horizontalScroll: false\n        });\n      }\n    }; // TODO: без порталов ломается сохранение фокуса внутри модалки\n    // NOTE: в ie нормально не работает\n\n\n    _this.isDisableFocusLock = function () {\n      return !ReactDOM.createPortal || ensureOldIEClassName_1.isIE;\n    };\n\n    _this.handleResize = function (event) {\n      LayoutEvents_1[\"default\"].emit();\n    };\n\n    return _this;\n  }\n\n  Modal.prototype.componentDidMount = function () {\n    this.stackSubscription = ModalStack_1[\"default\"].add(this, this.handleStackChange);\n\n    if (mountedModalsCount === 0) {\n      window.addEventListener('resize', this.checkHorizontalScrollAppearance);\n    }\n\n    mountedModalsCount++;\n    window.addEventListener('keydown', this.handleKeyDown);\n    this.checkHorizontalScrollAppearance();\n\n    if (this.containerNode) {\n      this.containerNode.addEventListener('scroll', LayoutEvents_1[\"default\"].emit);\n    }\n  };\n\n  Modal.prototype.componentWillUnmount = function () {\n    if (--mountedModalsCount === 0) {\n      window.removeEventListener('resize', this.checkHorizontalScrollAppearance);\n      LayoutEvents_1[\"default\"].emit();\n    }\n\n    window.removeEventListener('keydown', this.handleKeyDown);\n\n    if (this.stackSubscription != null) {\n      this.stackSubscription.remove();\n    }\n\n    ModalStack_1[\"default\"].remove(this);\n\n    if (this.containerNode) {\n      this.containerNode.removeEventListener('scroll', LayoutEvents_1[\"default\"].emit);\n    }\n  };\n\n  Modal.prototype.render = function () {\n    var _this = this;\n\n    return React.createElement(ThemeConsumer_1.ThemeConsumer, null, function (theme) {\n      _this.theme = theme;\n      return _this.renderMain();\n    });\n  };\n\n  Modal.prototype.renderMain = function () {\n    var _a;\n\n    var hasHeader = false;\n    var hasFooter = false;\n    var hasPanel = false;\n    React.Children.toArray(this.props.children).forEach(function (child) {\n      if (ModalHeader_1.isHeader(child)) {\n        hasHeader = true;\n      }\n\n      if (ModalFooter_1.isFooter(child)) {\n        hasFooter = true;\n\n        if (child.props.panel) {\n          hasPanel = true;\n        }\n      }\n    });\n    var modalContextProps = {\n      hasHeader: hasHeader,\n      horizontalScroll: this.state.horizontalScroll\n    };\n\n    if (hasHeader && !this.props.noClose) {\n      modalContextProps.close = {\n        disableClose: this.props.disableClose,\n        requestClose: this.requestClose\n      };\n    }\n\n    if (!hasFooter) {\n      modalContextProps.additionalPadding = true;\n    }\n\n    if (hasFooter && hasPanel) {\n      modalContextProps.additionalPadding = true;\n    }\n\n    var style = {};\n    var containerStyle = {};\n\n    if (this.props.width) {\n      style.width = this.props.width;\n    } else {\n      containerStyle.width = 'auto';\n    }\n\n    return React.createElement(RenderContainer_1[\"default\"], null, React.createElement(ZIndex_1[\"default\"], {\n      priority: 'Modal',\n      className: Modal_module_less_1[\"default\"].root\n    }, React.createElement(HideBodyVerticalScroll_1[\"default\"], null), this.state.stackPosition === 0 && React.createElement(\"div\", {\n      className: Emotion_1.cx(Modal_module_less_1[\"default\"].bg, Modal_styles_1[\"default\"].bg(this.theme))\n    }), React.createElement(\"div\", {\n      ref: this.refContainer,\n      className: Modal_module_less_1[\"default\"].container,\n      onMouseDown: this.handleContainerMouseDown,\n      onMouseUp: this.handleContainerMouseUp,\n      onClick: this.handleContainerClick,\n      \"data-tid\": \"modal-container\"\n    }, React.createElement(\"div\", {\n      className: Emotion_1.cx(Modal_module_less_1[\"default\"].centerContainer, Modal_styles_1[\"default\"].centerContainer(this.theme), (_a = {}, _a[Modal_module_less_1[\"default\"].alignTop] = !!this.props.alignTop, _a)),\n      style: containerStyle\n    }, React.createElement(\"div\", {\n      className: Emotion_1.cx(Modal_module_less_1[\"default\"].window, Modal_styles_1[\"default\"].window(this.theme)),\n      style: style\n    }, React.createElement(ResizeDetector_1[\"default\"], {\n      onResize: this.handleResize\n    }, React.createElement(react_focus_lock_1[\"default\"], {\n      disabled: this.isDisableFocusLock(),\n      autoFocus: false\n    }, !hasHeader && !this.props.noClose ? React.createElement(ZIndex_1[\"default\"], {\n      priority: 'ModalCross',\n      className: Modal_styles_1[\"default\"].closeWrapper()\n    }, React.createElement(ModalClose_1[\"default\"], {\n      requestClose: this.requestClose,\n      disableClose: this.props.disableClose\n    })) : null, React.createElement(ModalContext_1.ModalContext.Provider, {\n      value: modalContextProps\n    }, React.createElement(\"div\", null, this.props.children)))))))));\n  };\n\n  Modal.__KONTUR_REACT_UI__ = 'Modal';\n  Modal.Header = ModalHeader_1.Header;\n  Modal.Body = ModalBody_1.Body;\n  Modal.Footer = ModalFooter_1.Footer;\n  Modal.propTypes = {\n    children: function children(props, propName, componentName) {\n      if (React.Children.toArray(props[propName]).some(function (child) {\n        return !ModalHeader_1.isHeader(child) && !helpers_1.isBody(child) && !ModalFooter_1.isFooter(child);\n      })) {\n        return new Error(\"Only 'Header/Body/Footer' components are allowed for '\" + propName + \"' prop of '\" + componentName + \"' component\");\n      }\n    }\n  };\n  return Modal;\n}(React.Component);\n\nexports[\"default\"] = Modal;","map":{"version":3,"sources":["/home/aleksandr/coursework.front/node_modules/@skbkontur/react-ui/components/Modal/Modal.js"],"names":["Object","defineProperty","exports","value","tslib_1","require","React","__importStar","ReactDOM","react_focus_lock_1","__importDefault","identifiers_1","LayoutEvents_1","RenderContainer_1","ZIndex_1","stopPropagation_1","HideBodyVerticalScroll_1","ModalStack_1","ModalContext_1","ModalFooter_1","ModalHeader_1","ModalBody_1","ModalClose_1","ResizeDetector_1","ensureOldIEClassName_1","Modal_module_less_1","Emotion_1","Modal_styles_1","ThemeConsumer_1","helpers_1","mountedModalsCount","Modal","_super","__extends","_this","apply","arguments","state","stackPosition","horizontalScroll","stackSubscription","containerNode","mouseDownTarget","mouseUpTarget","requestClose","props","disableClose","onClose","refContainer","center","handleStackChange","stack","setState","indexOf","handleContainerMouseDown","event","target","handleContainerMouseUp","handleContainerClick","ignoreBackgroundClick","currentTarget","handleKeyDown","e","isKeyEscape","checkHorizontalScrollAppearance","hasScroll","containerClientWidth","clientWidth","containerScrollWidth","scrollWidth","isDisableFocusLock","createPortal","isIE","handleResize","emit","prototype","componentDidMount","add","window","addEventListener","componentWillUnmount","removeEventListener","remove","render","createElement","ThemeConsumer","theme","renderMain","_a","hasHeader","hasFooter","hasPanel","Children","toArray","children","forEach","child","isHeader","isFooter","panel","modalContextProps","noClose","close","additionalPadding","style","containerStyle","width","priority","className","root","cx","bg","ref","container","onMouseDown","onMouseUp","onClick","centerContainer","alignTop","onResize","disabled","autoFocus","closeWrapper","ModalContext","Provider","__KONTUR_REACT_UI__","Header","Body","Footer","propTypes","propName","componentName","some","isBody","Error","Component"],"mappings":"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","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar tslib_1 = require(\"tslib\");\nvar React = tslib_1.__importStar(require(\"react\"));\nvar ReactDOM = tslib_1.__importStar(require(\"react-dom\"));\nvar react_focus_lock_1 = tslib_1.__importDefault(require(\"react-focus-lock\"));\nvar identifiers_1 = require(\"../../lib/events/keyboard/identifiers\");\nvar LayoutEvents_1 = tslib_1.__importDefault(require(\"../../lib/LayoutEvents\"));\nvar RenderContainer_1 = tslib_1.__importDefault(require(\"../RenderContainer/RenderContainer\"));\nvar ZIndex_1 = tslib_1.__importDefault(require(\"../ZIndex/ZIndex\"));\nvar stopPropagation_1 = tslib_1.__importDefault(require(\"../../lib/events/stopPropagation\"));\nvar HideBodyVerticalScroll_1 = tslib_1.__importDefault(require(\"../HideBodyVerticalScroll/HideBodyVerticalScroll\"));\nvar ModalStack_1 = tslib_1.__importDefault(require(\"../ModalStack\"));\nvar ModalContext_1 = require(\"./ModalContext\");\nvar ModalFooter_1 = require(\"./ModalFooter\");\nvar ModalHeader_1 = require(\"./ModalHeader\");\nvar ModalBody_1 = require(\"./ModalBody\");\nvar ModalClose_1 = tslib_1.__importDefault(require(\"./ModalClose\"));\nvar ResizeDetector_1 = tslib_1.__importDefault(require(\"../internal/ResizeDetector\"));\nvar ensureOldIEClassName_1 = require(\"../ensureOldIEClassName\");\nvar Modal_module_less_1 = tslib_1.__importDefault(require(\"./Modal.module.css\"));\nvar Emotion_1 = require(\"../../lib/theming/Emotion\");\nvar Modal_styles_1 = tslib_1.__importDefault(require(\"./Modal.styles\"));\nvar ThemeConsumer_1 = require(\"../ThemeConsumer\");\nvar helpers_1 = require(\"./helpers\");\nvar mountedModalsCount = 0;\n/**\r\n                             * Модальное окно\r\n                             *\r\n                             * Содержит в себе три компоненты: **Modal.Header**,\r\n                             * **Modal.Body** и **Modal.Footer**\r\n                             *\r\n                             * Для отображения серой плашки в футере в компонент\r\n                             * **Footer** необходимо передать пропс **panel**\r\n                             *\r\n                             * Для отключения прилипания шапки и футера\r\n                             * в соответствующий компонет нужно передать\r\n                             * проп **sticky** со значением **false**\r\n                             * (по-умолчанию прилипание включено)\r\n                             */\nvar Modal = /** @class */function (_super) {\n  tslib_1.__extends(Modal, _super);\n  function Modal() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n    _this.state = {\n      stackPosition: 0,\n      horizontalScroll: false };\n\n    _this.stackSubscription = null;\n    _this.containerNode = null;\n    _this.mouseDownTarget = null;\n    _this.mouseUpTarget = null;\n    _this.requestClose = function () {\n      if (_this.props.disableClose) {\n        return;\n      }\n      if (_this.props.onClose) {\n        _this.props.onClose();\n      }\n    };\n    _this.refContainer = function (center) {\n      _this.containerNode = center;\n    };\n    _this.handleStackChange = function (stack) {\n      _this.setState({ stackPosition: stack.indexOf(_this) });\n    };\n    _this.handleContainerMouseDown = function (event) {\n      _this.mouseDownTarget = event.target;\n    };\n    _this.handleContainerMouseUp = function (event) {\n      _this.mouseUpTarget = event.target;\n    };\n    _this.handleContainerClick = function (event) {\n      if (!_this.props.ignoreBackgroundClick) {\n        var target = event.target,currentTarget = event.currentTarget;\n        if (target === currentTarget && _this.mouseDownTarget === currentTarget && _this.mouseUpTarget === currentTarget) {\n          _this.requestClose();\n        }\n      }\n    };\n    _this.handleKeyDown = function (e) {\n      if (_this.state.stackPosition !== 0) {\n        return;\n      }\n      if (identifiers_1.isKeyEscape(e)) {\n        stopPropagation_1[\"default\"](e);\n        _this.requestClose();\n      }\n    };\n    _this.checkHorizontalScrollAppearance = function () {\n      var hasScroll = false;\n      if (_this.containerNode) {\n        var containerClientWidth = _this.containerNode.clientWidth;\n        var containerScrollWidth = _this.containerNode.scrollWidth;\n        hasScroll = containerClientWidth < containerScrollWidth;\n      }\n      if (hasScroll && !_this.state.horizontalScroll) {\n        _this.setState({ horizontalScroll: true });\n      } else\n      if (_this.state.horizontalScroll) {\n        _this.setState({ horizontalScroll: false });\n      }\n    };\n    // TODO: без порталов ломается сохранение фокуса внутри модалки\n    // NOTE: в ie нормально не работает\n    _this.isDisableFocusLock = function () {\n      return !ReactDOM.createPortal || ensureOldIEClassName_1.isIE;\n    };\n    _this.handleResize = function (event) {\n      LayoutEvents_1[\"default\"].emit();\n    };\n    return _this;\n  }\n  Modal.prototype.componentDidMount = function () {\n    this.stackSubscription = ModalStack_1[\"default\"].add(this, this.handleStackChange);\n    if (mountedModalsCount === 0) {\n      window.addEventListener('resize', this.checkHorizontalScrollAppearance);\n    }\n    mountedModalsCount++;\n    window.addEventListener('keydown', this.handleKeyDown);\n    this.checkHorizontalScrollAppearance();\n    if (this.containerNode) {\n      this.containerNode.addEventListener('scroll', LayoutEvents_1[\"default\"].emit);\n    }\n  };\n  Modal.prototype.componentWillUnmount = function () {\n    if (--mountedModalsCount === 0) {\n      window.removeEventListener('resize', this.checkHorizontalScrollAppearance);\n      LayoutEvents_1[\"default\"].emit();\n    }\n    window.removeEventListener('keydown', this.handleKeyDown);\n    if (this.stackSubscription != null) {\n      this.stackSubscription.remove();\n    }\n    ModalStack_1[\"default\"].remove(this);\n    if (this.containerNode) {\n      this.containerNode.removeEventListener('scroll', LayoutEvents_1[\"default\"].emit);\n    }\n  };\n  Modal.prototype.render = function () {\n    var _this = this;\n    return React.createElement(ThemeConsumer_1.ThemeConsumer, null, function (theme) {\n      _this.theme = theme;\n      return _this.renderMain();\n    });\n  };\n  Modal.prototype.renderMain = function () {\n    var _a;\n    var hasHeader = false;\n    var hasFooter = false;\n    var hasPanel = false;\n    React.Children.toArray(this.props.children).forEach(function (child) {\n      if (ModalHeader_1.isHeader(child)) {\n        hasHeader = true;\n      }\n      if (ModalFooter_1.isFooter(child)) {\n        hasFooter = true;\n        if (child.props.panel) {\n          hasPanel = true;\n        }\n      }\n    });\n    var modalContextProps = {\n      hasHeader: hasHeader,\n      horizontalScroll: this.state.horizontalScroll };\n\n    if (hasHeader && !this.props.noClose) {\n      modalContextProps.close = {\n        disableClose: this.props.disableClose,\n        requestClose: this.requestClose };\n\n    }\n    if (!hasFooter) {\n      modalContextProps.additionalPadding = true;\n    }\n    if (hasFooter && hasPanel) {\n      modalContextProps.additionalPadding = true;\n    }\n    var style = {};\n    var containerStyle = {};\n    if (this.props.width) {\n      style.width = this.props.width;\n    } else\n    {\n      containerStyle.width = 'auto';\n    }\n    return React.createElement(RenderContainer_1[\"default\"], null,\n    React.createElement(ZIndex_1[\"default\"], { priority: 'Modal', className: Modal_module_less_1[\"default\"].root },\n    React.createElement(HideBodyVerticalScroll_1[\"default\"], null),\n    this.state.stackPosition === 0 && React.createElement(\"div\", { className: Emotion_1.cx(Modal_module_less_1[\"default\"].bg, Modal_styles_1[\"default\"].bg(this.theme)) }),\n    React.createElement(\"div\", { ref: this.refContainer, className: Modal_module_less_1[\"default\"].container, onMouseDown: this.handleContainerMouseDown, onMouseUp: this.handleContainerMouseUp, onClick: this.handleContainerClick, \"data-tid\": \"modal-container\" },\n    React.createElement(\"div\", { className: Emotion_1.cx(Modal_module_less_1[\"default\"].centerContainer, Modal_styles_1[\"default\"].centerContainer(this.theme), (_a = {},\n      _a[Modal_module_less_1[\"default\"].alignTop] = !!this.props.alignTop,\n      _a)), style: containerStyle },\n    React.createElement(\"div\", { className: Emotion_1.cx(Modal_module_less_1[\"default\"].window, Modal_styles_1[\"default\"].window(this.theme)), style: style },\n    React.createElement(ResizeDetector_1[\"default\"], { onResize: this.handleResize },\n    React.createElement(react_focus_lock_1[\"default\"], { disabled: this.isDisableFocusLock(), autoFocus: false },\n    !hasHeader && !this.props.noClose ? React.createElement(ZIndex_1[\"default\"], { priority: 'ModalCross', className: Modal_styles_1[\"default\"].closeWrapper() },\n    React.createElement(ModalClose_1[\"default\"], { requestClose: this.requestClose, disableClose: this.props.disableClose })) : null,\n    React.createElement(ModalContext_1.ModalContext.Provider, { value: modalContextProps },\n    React.createElement(\"div\", null, this.props.children)))))))));\n  };\n  Modal.__KONTUR_REACT_UI__ = 'Modal';\n  Modal.Header = ModalHeader_1.Header;\n  Modal.Body = ModalBody_1.Body;\n  Modal.Footer = ModalFooter_1.Footer;\n  Modal.propTypes = {\n    children: function children(props, propName, componentName) {\n      if (React.Children.toArray(props[propName]).some(function (child) {return !ModalHeader_1.isHeader(child) && !helpers_1.isBody(child) && !ModalFooter_1.isFooter(child);})) {\n        return new Error(\"Only 'Header/Body/Footer' components are allowed for '\" + propName + \"' prop of '\" + componentName + \"' component\");\n      }\n    } };\n\n  return Modal;\n}(React.Component);\nexports[\"default\"] = Modal;"]},"metadata":{},"sourceType":"script"}