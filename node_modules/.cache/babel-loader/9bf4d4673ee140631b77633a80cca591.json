{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar tslib_1 = require(\"tslib\");\n\nvar React = tslib_1.__importStar(require(\"react\"));\n\nvar react_dom_1 = tslib_1.__importDefault(require(\"react-dom\"));\n\nvar identifiers_1 = require(\"../../../lib/events/keyboard/identifiers\");\n\nvar isActiveElement_1 = tslib_1.__importDefault(require(\"./isActiveElement\"));\n\nvar ScrollContainer_1 = tslib_1.__importDefault(require(\"../../ScrollContainer/ScrollContainer\"));\n\nvar MenuItem_1 = require(\"../../MenuItem\");\n\nvar MenuHeader_1 = require(\"../../MenuHeader\");\n\nvar InternalMenu_module_less_1 = tslib_1.__importDefault(require(\"./InternalMenu.module.css\"));\n\nvar createPropsGetter_1 = require(\"../createPropsGetter\");\n\nvar Emotion_1 = require(\"../../../lib/theming/Emotion\");\n\nvar InternalMenu_styles_1 = tslib_1.__importDefault(require(\"./InternalMenu.styles\"));\n\nvar ThemeConsumer_1 = require(\"../../ThemeConsumer\");\n\nvar InternalMenu =\n/** @class */\nfunction (_super) {\n  tslib_1.__extends(InternalMenu, _super);\n\n  function InternalMenu() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.state = {\n      highlightedIndex: -1,\n      maxHeight: _this.props.maxHeight || 'none',\n      scrollState: 'top'\n    };\n    _this.getProps = createPropsGetter_1.createPropsGetter(InternalMenu.defaultProps);\n\n    _this.renderHeader = function () {\n      var _a;\n\n      return React.createElement(\"div\", {\n        ref: function ref(el) {\n          return _this.header = el;\n        },\n        className: Emotion_1.cx((_a = {}, _a[InternalMenu_module_less_1[\"default\"].header] = true, _a[InternalMenu_module_less_1[\"default\"].fixedHeader] = _this.state.scrollState !== 'top', _a))\n      }, _this.props.header);\n    };\n\n    _this.renderFooter = function () {\n      var _a;\n\n      return React.createElement(\"div\", {\n        ref: function ref(el) {\n          return _this.footer = el;\n        },\n        className: Emotion_1.cx((_a = {}, _a[InternalMenu_module_less_1[\"default\"].footer] = true, _a[InternalMenu_module_less_1[\"default\"].fixedFooter] = _this.state.scrollState !== 'bottom', _a))\n      }, _this.props.footer);\n    };\n\n    _this.focusOnRootElement = function () {\n      if (_this.rootElement) {\n        _this.rootElement.focus();\n      }\n    };\n\n    _this.shouldRecalculateMaxHeight = function (prevProps) {\n      var _a = _this.props,\n          maxHeight = _a.maxHeight,\n          header = _a.header,\n          footer = _a.footer,\n          children = _a.children;\n      var prevMaxHeight = prevProps.maxHeight;\n      var prevHeader = prevProps.header;\n      var prevFooter = prevProps.footer;\n      var prevChildrenCount = React.Children.count(prevProps.children);\n      return maxHeight !== prevMaxHeight || footer !== prevFooter || header !== prevHeader || React.Children.count(children) !== prevChildrenCount;\n    };\n\n    _this.calculateMaxHeight = function () {\n      var maxHeight = _this.props.maxHeight;\n      var parsedMaxHeight = maxHeight;\n      var calculatedMaxHeight;\n\n      if (typeof maxHeight === 'string' && typeof window !== 'undefined' && _this.rootElement) {\n        var rootElementMaxHeight = window.getComputedStyle(_this.rootElement).maxHeight;\n\n        if (rootElementMaxHeight) {\n          parsedMaxHeight = parseFloat(rootElementMaxHeight);\n        }\n      }\n\n      calculatedMaxHeight = typeof parsedMaxHeight === 'number' ? parsedMaxHeight + (_this.header && _this.header.getBoundingClientRect().height || 0) + (_this.footer && _this.footer.getBoundingClientRect().height || 0) : maxHeight;\n\n      _this.setState({\n        maxHeight: calculatedMaxHeight || 'none'\n      });\n    };\n\n    _this.setInitialSelection = function () {\n      for (var i = _this.getProps().initialSelectedItemIndex; i > -1; i--) {\n        _this.moveDown();\n      }\n    };\n\n    _this.refScrollContainer = function (scrollContainer) {\n      _this.scrollContainer = scrollContainer;\n    };\n\n    _this.scrollToSelected = function () {\n      if (_this.scrollContainer && _this.highlighted) {\n        _this.scrollContainer.scrollTo(react_dom_1[\"default\"].findDOMNode(_this.highlighted));\n      }\n    };\n\n    _this.highlightItem = function (index) {\n      _this.setState({\n        highlightedIndex: index\n      });\n\n      if (_this.rootElement) {\n        _this.rootElement.focus();\n      }\n    };\n\n    _this.unhighlight = function () {\n      _this.setState({\n        highlightedIndex: -1\n      });\n    };\n\n    _this.moveUp = function () {\n      _this.move(-1);\n    };\n\n    _this.moveDown = function () {\n      _this.move(1);\n    };\n\n    _this.handleKeyDown = function (e) {\n      if (typeof _this.props.onKeyDown === 'function') {\n        _this.props.onKeyDown(e);\n      }\n\n      if (e.defaultPrevented) {\n        return;\n      }\n\n      if (identifiers_1.isKeyArrowUp(e)) {\n        e.preventDefault();\n\n        _this.moveUp();\n      } else if (identifiers_1.isKeyArrowDown(e)) {\n        e.preventDefault();\n\n        _this.moveDown();\n      } else if (identifiers_1.isKeyEnter(e)) {\n        if (_this.highlighted && _this.highlighted.props.onClick) {\n          _this.highlighted.props.onClick(e);\n        }\n      }\n    };\n\n    _this.handleScrollStateChange = function (scrollState) {\n      if (_this.state.scrollState !== scrollState) {\n        _this.setState({\n          scrollState: scrollState\n        });\n      }\n    };\n\n    return _this;\n  }\n\n  InternalMenu.prototype.componentDidMount = function () {\n    this.setInitialSelection();\n    this.calculateMaxHeight();\n  };\n\n  InternalMenu.prototype.componentDidUpdate = function (prevProps, prevState) {\n    if (this.shouldRecalculateMaxHeight(prevProps)) {\n      this.calculateMaxHeight();\n    }\n  };\n\n  InternalMenu.prototype.componentWillReceiveProps = function (nextProps) {\n    if (nextProps.maxHeight !== this.props.maxHeight) {\n      this.setState({\n        maxHeight: nextProps.maxHeight || 'none'\n      });\n    }\n  };\n\n  InternalMenu.prototype.focus = function () {\n    this.focusOnRootElement();\n  };\n\n  InternalMenu.prototype.render = function () {\n    var _this = this;\n\n    return React.createElement(ThemeConsumer_1.ThemeConsumer, null, function (theme) {\n      _this.theme = theme;\n      return _this.renderMain();\n    });\n  };\n\n  InternalMenu.prototype.renderMain = function () {\n    var _this = this;\n\n    var enableIconPadding = React.Children.toArray(this.props.children).some(function (x) {\n      return typeof x === 'object' && x.props.icon;\n    });\n\n    if (this.isEmpty()) {\n      return null;\n    }\n\n    return React.createElement(\"div\", {\n      className: Emotion_1.cx(InternalMenu_module_less_1[\"default\"].root, InternalMenu_styles_1[\"default\"].root(this.theme), this.props.hasShadow && InternalMenu_module_less_1[\"default\"].shadow),\n      style: {\n        width: this.props.width,\n        maxHeight: this.state.maxHeight\n      },\n      onKeyDown: this.handleKeyDown,\n      ref: function ref(element) {\n        _this.rootElement = element;\n      },\n      tabIndex: 0\n    }, this.props.header ? this.renderHeader() : null, React.createElement(ScrollContainer_1[\"default\"], {\n      ref: this.refScrollContainer,\n      maxHeight: this.props.maxHeight,\n      preventWindowScroll: this.props.preventWindowScroll,\n      onScrollStateChange: this.handleScrollStateChange\n    }, React.Children.map(this.props.children, function (child, index) {\n      if (typeof child === 'string' || typeof child === 'number' || child == null) {\n        return child;\n      }\n\n      if (typeof child.type === 'string') {\n        return child;\n      }\n\n      if (enableIconPadding && (MenuItem_1.isMenuItem(child) || MenuHeader_1.isMenuHeader(child))) {\n        child = React.cloneElement(child, {\n          _enableIconPadding: true\n        });\n      }\n\n      if (isActiveElement_1[\"default\"](child)) {\n        var highlight = _this.state.highlightedIndex === index;\n        var ref = child.ref;\n        var originalRef_1 = ref;\n\n        if (highlight) {\n          ref = function ref(menuItem) {\n            return _this.refHighlighted(originalRef_1, menuItem);\n          };\n        }\n\n        return React.cloneElement(child, {\n          ref: ref,\n          state: highlight ? 'hover' : child.props.state,\n          onClick: _this.select.bind(_this, index, false),\n          onMouseEnter: function onMouseEnter(event) {\n            _this.highlightItem(index);\n\n            if (MenuItem_1.isMenuItem(child) && child.props.onMouseEnter) {\n              child.props.onMouseEnter(event);\n            }\n          },\n          onMouseLeave: function onMouseLeave(event) {\n            _this.unhighlight();\n\n            if (MenuItem_1.isMenuItem(child) && child.props.onMouseLeave) {\n              child.props.onMouseLeave(event);\n            }\n          }\n        });\n      }\n\n      return child;\n    })), this.props.footer ? this.renderFooter() : null);\n  };\n\n  InternalMenu.prototype.refHighlighted = function (originalRef, menuItem) {\n    this.highlighted = menuItem;\n\n    if (!originalRef || typeof originalRef === 'string') {\n      return;\n    }\n\n    if (typeof originalRef === 'function') {\n      originalRef(menuItem);\n    } else if (typeof originalRef === 'object') {\n      // @ts-ignore see issue https://github.com/DefinitelyTyped/DefinitelyTyped/issues/31065\n      originalRef.current = menuItem;\n    }\n  };\n\n  InternalMenu.prototype.select = function (index, shouldHandleHref, event) {\n    var item = childrenToArray(this.props.children)[index];\n\n    if (isActiveElement_1[\"default\"](item)) {\n      if (shouldHandleHref && item.props.href) {\n        if (item.props.target) {\n          window.open(item.props.href, item.props.target);\n        } else {\n          location.href = item.props.href;\n        }\n      }\n\n      if (item.props.onClick) {\n        item.props.onClick(event);\n      }\n\n      if (this.props.onItemClick) {\n        this.props.onItemClick(event);\n      }\n\n      return true;\n    }\n\n    return false;\n  };\n\n  InternalMenu.prototype.move = function (step) {\n    this.setState(function (state, props) {\n      var children = childrenToArray(props.children);\n\n      if (!children.some(isActiveElement_1[\"default\"])) {\n        return null;\n      }\n\n      var index = state.highlightedIndex;\n\n      do {\n        index += step;\n\n        if (!props.cyclicSelection && (index < 0 || index > children.length)) {\n          return null;\n        }\n\n        if (index < 0) {\n          index = children.length - 1;\n        } else if (index > children.length) {\n          index = 0;\n        }\n\n        var child = children[index];\n\n        if (isActiveElement_1[\"default\"](child)) {\n          return {\n            highlightedIndex: index\n          };\n        }\n      } while (index !== state.highlightedIndex);\n\n      return null;\n    }, this.scrollToSelected);\n  };\n\n  InternalMenu.prototype.isEmpty = function () {\n    var children = this.props.children;\n    return !children || !childrenToArray(children).filter(isExist).length;\n  };\n\n  InternalMenu.__KONTUR_REACT_UI__ = 'InternalMenu';\n  InternalMenu.defaultProps = {\n    width: 'auto',\n    maxHeight: 300,\n    hasShadow: true,\n    preventWindowScroll: true,\n    cyclicSelection: true,\n    initialSelectedItemIndex: -1\n  };\n  return InternalMenu;\n}(React.Component);\n\nexports[\"default\"] = InternalMenu;\n\nfunction isExist(value) {\n  return value !== null && value !== undefined;\n}\n\nfunction childrenToArray(children) {\n  var ret = []; // Use forEach instead of map to avoid cloning for key unifying.\n\n  React.Children.forEach(children, function (child) {\n    ret.push(child);\n  });\n  return ret;\n}","map":{"version":3,"sources":["/home/aleksandr/coursework.front/node_modules/@skbkontur/react-ui/components/internal/InternalMenu/InternalMenu.js"],"names":["Object","defineProperty","exports","value","tslib_1","require","React","__importStar","react_dom_1","__importDefault","identifiers_1","isActiveElement_1","ScrollContainer_1","MenuItem_1","MenuHeader_1","InternalMenu_module_less_1","createPropsGetter_1","Emotion_1","InternalMenu_styles_1","ThemeConsumer_1","InternalMenu","_super","__extends","_this","apply","arguments","state","highlightedIndex","maxHeight","props","scrollState","getProps","createPropsGetter","defaultProps","renderHeader","_a","createElement","ref","el","header","className","cx","fixedHeader","renderFooter","footer","fixedFooter","focusOnRootElement","rootElement","focus","shouldRecalculateMaxHeight","prevProps","children","prevMaxHeight","prevHeader","prevFooter","prevChildrenCount","Children","count","calculateMaxHeight","parsedMaxHeight","calculatedMaxHeight","window","rootElementMaxHeight","getComputedStyle","parseFloat","getBoundingClientRect","height","setState","setInitialSelection","i","initialSelectedItemIndex","moveDown","refScrollContainer","scrollContainer","scrollToSelected","highlighted","scrollTo","findDOMNode","highlightItem","index","unhighlight","moveUp","move","handleKeyDown","e","onKeyDown","defaultPrevented","isKeyArrowUp","preventDefault","isKeyArrowDown","isKeyEnter","onClick","handleScrollStateChange","prototype","componentDidMount","componentDidUpdate","prevState","componentWillReceiveProps","nextProps","render","ThemeConsumer","theme","renderMain","enableIconPadding","toArray","some","x","icon","isEmpty","root","hasShadow","shadow","style","width","element","tabIndex","preventWindowScroll","onScrollStateChange","map","child","type","isMenuItem","isMenuHeader","cloneElement","_enableIconPadding","highlight","originalRef_1","menuItem","refHighlighted","select","bind","onMouseEnter","event","onMouseLeave","originalRef","current","shouldHandleHref","item","childrenToArray","href","target","open","location","onItemClick","step","cyclicSelection","length","filter","isExist","__KONTUR_REACT_UI__","Component","undefined","ret","forEach","push"],"mappings":"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","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar tslib_1 = require(\"tslib\");\nvar React = tslib_1.__importStar(require(\"react\"));\nvar react_dom_1 = tslib_1.__importDefault(require(\"react-dom\"));\nvar identifiers_1 = require(\"../../../lib/events/keyboard/identifiers\");\nvar isActiveElement_1 = tslib_1.__importDefault(require(\"./isActiveElement\"));\nvar ScrollContainer_1 = tslib_1.__importDefault(require(\"../../ScrollContainer/ScrollContainer\"));\nvar MenuItem_1 = require(\"../../MenuItem\");\nvar MenuHeader_1 = require(\"../../MenuHeader\");\nvar InternalMenu_module_less_1 = tslib_1.__importDefault(require(\"./InternalMenu.module.css\"));\nvar createPropsGetter_1 = require(\"../createPropsGetter\");\nvar Emotion_1 = require(\"../../../lib/theming/Emotion\");\nvar InternalMenu_styles_1 = tslib_1.__importDefault(require(\"./InternalMenu.styles\"));\nvar ThemeConsumer_1 = require(\"../../ThemeConsumer\");\nvar InternalMenu = /** @class */function (_super) {\n  tslib_1.__extends(InternalMenu, _super);\n  function InternalMenu() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n    _this.state = {\n      highlightedIndex: -1,\n      maxHeight: _this.props.maxHeight || 'none',\n      scrollState: 'top' };\n\n    _this.getProps = createPropsGetter_1.createPropsGetter(InternalMenu.defaultProps);\n    _this.renderHeader = function () {\n      var _a;\n      return React.createElement(\"div\", { ref: function ref(el) {return _this.header = el;}, className: Emotion_1.cx((_a = {},\n        _a[InternalMenu_module_less_1[\"default\"].header] = true,\n        _a[InternalMenu_module_less_1[\"default\"].fixedHeader] = _this.state.scrollState !== 'top',\n        _a)) }, _this.props.header);\n    };\n    _this.renderFooter = function () {\n      var _a;\n      return React.createElement(\"div\", { ref: function ref(el) {return _this.footer = el;}, className: Emotion_1.cx((_a = {},\n        _a[InternalMenu_module_less_1[\"default\"].footer] = true,\n        _a[InternalMenu_module_less_1[\"default\"].fixedFooter] = _this.state.scrollState !== 'bottom',\n        _a)) }, _this.props.footer);\n    };\n    _this.focusOnRootElement = function () {\n      if (_this.rootElement) {\n        _this.rootElement.focus();\n      }\n    };\n    _this.shouldRecalculateMaxHeight = function (prevProps) {\n      var _a = _this.props,maxHeight = _a.maxHeight,header = _a.header,footer = _a.footer,children = _a.children;\n      var prevMaxHeight = prevProps.maxHeight;\n      var prevHeader = prevProps.header;\n      var prevFooter = prevProps.footer;\n      var prevChildrenCount = React.Children.count(prevProps.children);\n      return maxHeight !== prevMaxHeight ||\n      footer !== prevFooter ||\n      header !== prevHeader ||\n      React.Children.count(children) !== prevChildrenCount;\n    };\n    _this.calculateMaxHeight = function () {\n      var maxHeight = _this.props.maxHeight;\n      var parsedMaxHeight = maxHeight;\n      var calculatedMaxHeight;\n      if (typeof maxHeight === 'string' && typeof window !== 'undefined' && _this.rootElement) {\n        var rootElementMaxHeight = window.getComputedStyle(_this.rootElement).maxHeight;\n        if (rootElementMaxHeight) {\n          parsedMaxHeight = parseFloat(rootElementMaxHeight);\n        }\n      }\n      calculatedMaxHeight =\n      typeof parsedMaxHeight === 'number' ?\n      parsedMaxHeight + (\n      _this.header && _this.header.getBoundingClientRect().height || 0) + (\n      _this.footer && _this.footer.getBoundingClientRect().height || 0) :\n      maxHeight;\n      _this.setState({\n        maxHeight: calculatedMaxHeight || 'none' });\n\n    };\n    _this.setInitialSelection = function () {\n      for (var i = _this.getProps().initialSelectedItemIndex; i > -1; i--) {\n        _this.moveDown();\n      }\n    };\n    _this.refScrollContainer = function (scrollContainer) {\n      _this.scrollContainer = scrollContainer;\n    };\n    _this.scrollToSelected = function () {\n      if (_this.scrollContainer && _this.highlighted) {\n        _this.scrollContainer.scrollTo(react_dom_1[\"default\"].findDOMNode(_this.highlighted));\n      }\n    };\n    _this.highlightItem = function (index) {\n      _this.setState({ highlightedIndex: index });\n      if (_this.rootElement) {\n        _this.rootElement.focus();\n      }\n    };\n    _this.unhighlight = function () {\n      _this.setState({ highlightedIndex: -1 });\n    };\n    _this.moveUp = function () {\n      _this.move(-1);\n    };\n    _this.moveDown = function () {\n      _this.move(1);\n    };\n    _this.handleKeyDown = function (e) {\n      if (typeof _this.props.onKeyDown === 'function') {\n        _this.props.onKeyDown(e);\n      }\n      if (e.defaultPrevented) {\n        return;\n      }\n      if (identifiers_1.isKeyArrowUp(e)) {\n        e.preventDefault();\n        _this.moveUp();\n      } else\n      if (identifiers_1.isKeyArrowDown(e)) {\n        e.preventDefault();\n        _this.moveDown();\n      } else\n      if (identifiers_1.isKeyEnter(e)) {\n        if (_this.highlighted && _this.highlighted.props.onClick) {\n          _this.highlighted.props.onClick(e);\n        }\n      }\n    };\n    _this.handleScrollStateChange = function (scrollState) {\n      if (_this.state.scrollState !== scrollState) {\n        _this.setState({ scrollState: scrollState });\n      }\n    };\n    return _this;\n  }\n  InternalMenu.prototype.componentDidMount = function () {\n    this.setInitialSelection();\n    this.calculateMaxHeight();\n  };\n  InternalMenu.prototype.componentDidUpdate = function (prevProps, prevState) {\n    if (this.shouldRecalculateMaxHeight(prevProps)) {\n      this.calculateMaxHeight();\n    }\n  };\n  InternalMenu.prototype.componentWillReceiveProps = function (nextProps) {\n    if (nextProps.maxHeight !== this.props.maxHeight) {\n      this.setState({\n        maxHeight: nextProps.maxHeight || 'none' });\n\n    }\n  };\n  InternalMenu.prototype.focus = function () {\n    this.focusOnRootElement();\n  };\n  InternalMenu.prototype.render = function () {\n    var _this = this;\n    return React.createElement(ThemeConsumer_1.ThemeConsumer, null, function (theme) {\n      _this.theme = theme;\n      return _this.renderMain();\n    });\n  };\n  InternalMenu.prototype.renderMain = function () {\n    var _this = this;\n    var enableIconPadding = React.Children.toArray(this.props.children).some(function (x) {return typeof x === 'object' && x.props.icon;});\n    if (this.isEmpty()) {\n      return null;\n    }\n    return React.createElement(\"div\", { className: Emotion_1.cx(InternalMenu_module_less_1[\"default\"].root, InternalMenu_styles_1[\"default\"].root(this.theme), this.props.hasShadow && InternalMenu_module_less_1[\"default\"].shadow), style: {\n        width: this.props.width,\n        maxHeight: this.state.maxHeight },\n      onKeyDown: this.handleKeyDown, ref: function ref(element) {\n        _this.rootElement = element;\n      }, tabIndex: 0 },\n    this.props.header ? this.renderHeader() : null,\n    React.createElement(ScrollContainer_1[\"default\"], { ref: this.refScrollContainer, maxHeight: this.props.maxHeight, preventWindowScroll: this.props.preventWindowScroll, onScrollStateChange: this.handleScrollStateChange }, React.Children.map(this.props.children, function (child, index) {\n      if (typeof child === 'string' || typeof child === 'number' || child == null) {\n        return child;\n      }\n      if (typeof child.type === 'string') {\n        return child;\n      }\n      if (enableIconPadding && (MenuItem_1.isMenuItem(child) || MenuHeader_1.isMenuHeader(child))) {\n        child = React.cloneElement(child, {\n          _enableIconPadding: true });\n\n      }\n      if (isActiveElement_1[\"default\"](child)) {\n        var highlight = _this.state.highlightedIndex === index;\n        var ref = child.ref;\n        var originalRef_1 = ref;\n        if (highlight) {\n          ref = function ref(menuItem) {return _this.refHighlighted(originalRef_1, menuItem);};\n        }\n        return React.cloneElement(child, {\n          ref: ref,\n          state: highlight ? 'hover' : child.props.state,\n          onClick: _this.select.bind(_this, index, false),\n          onMouseEnter: function onMouseEnter(event) {\n            _this.highlightItem(index);\n            if (MenuItem_1.isMenuItem(child) && child.props.onMouseEnter) {\n              child.props.onMouseEnter(event);\n            }\n          },\n          onMouseLeave: function onMouseLeave(event) {\n            _this.unhighlight();\n            if (MenuItem_1.isMenuItem(child) && child.props.onMouseLeave) {\n              child.props.onMouseLeave(event);\n            }\n          } });\n\n      }\n      return child;\n    })),\n    this.props.footer ? this.renderFooter() : null);\n  };\n  InternalMenu.prototype.refHighlighted = function (originalRef, menuItem) {\n    this.highlighted = menuItem;\n    if (!originalRef || typeof originalRef === 'string') {\n      return;\n    }\n    if (typeof originalRef === 'function') {\n      originalRef(menuItem);\n    } else\n    if (typeof originalRef === 'object') {\n      // @ts-ignore see issue https://github.com/DefinitelyTyped/DefinitelyTyped/issues/31065\n      originalRef.current = menuItem;\n    }\n  };\n  InternalMenu.prototype.select = function (index, shouldHandleHref, event) {\n    var item = childrenToArray(this.props.children)[index];\n    if (isActiveElement_1[\"default\"](item)) {\n      if (shouldHandleHref && item.props.href) {\n        if (item.props.target) {\n          window.open(item.props.href, item.props.target);\n        } else\n        {\n          location.href = item.props.href;\n        }\n      }\n      if (item.props.onClick) {\n        item.props.onClick(event);\n      }\n      if (this.props.onItemClick) {\n        this.props.onItemClick(event);\n      }\n      return true;\n    }\n    return false;\n  };\n  InternalMenu.prototype.move = function (step) {\n    this.setState(function (state, props) {\n      var children = childrenToArray(props.children);\n      if (!children.some(isActiveElement_1[\"default\"])) {\n        return null;\n      }\n      var index = state.highlightedIndex;\n      do {\n        index += step;\n        if (!props.cyclicSelection && (index < 0 || index > children.length)) {\n          return null;\n        }\n        if (index < 0) {\n          index = children.length - 1;\n        } else\n        if (index > children.length) {\n          index = 0;\n        }\n        var child = children[index];\n        if (isActiveElement_1[\"default\"](child)) {\n          return { highlightedIndex: index };\n        }\n      } while (index !== state.highlightedIndex);\n      return null;\n    }, this.scrollToSelected);\n  };\n  InternalMenu.prototype.isEmpty = function () {\n    var children = this.props.children;\n    return !children || !childrenToArray(children).filter(isExist).length;\n  };\n  InternalMenu.__KONTUR_REACT_UI__ = 'InternalMenu';\n  InternalMenu.defaultProps = {\n    width: 'auto',\n    maxHeight: 300,\n    hasShadow: true,\n    preventWindowScroll: true,\n    cyclicSelection: true,\n    initialSelectedItemIndex: -1 };\n\n  return InternalMenu;\n}(React.Component);\nexports[\"default\"] = InternalMenu;\nfunction isExist(value) {\n  return value !== null && value !== undefined;\n}\nfunction childrenToArray(children) {\n  var ret = [];\n  // Use forEach instead of map to avoid cloning for key unifying.\n  React.Children.forEach(children, function (child) {\n    ret.push(child);\n  });\n  return ret;\n}"]},"metadata":{},"sourceType":"script"}