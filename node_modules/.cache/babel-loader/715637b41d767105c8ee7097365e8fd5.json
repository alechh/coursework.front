{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar tslib_1 = require(\"tslib\");\n\nvar React = tslib_1.__importStar(require(\"react\"));\n\nvar react_dom_1 = require(\"react-dom\");\n\nvar PropTypes = tslib_1.__importStar(require(\"prop-types\"));\n\nvar safePropTypes = tslib_1.__importStar(require(\"../../lib/SSRSafePropTypes\"));\n\nvar RenderContainer_1 = tslib_1.__importDefault(require(\"../RenderContainer\"));\n\nvar ZIndex_1 = tslib_1.__importDefault(require(\"../ZIndex\"));\n\nvar react_transition_group_1 = require(\"react-transition-group\");\n\nvar raf_1 = tslib_1.__importDefault(require(\"raf\"));\n\nvar PopupHelper_1 = tslib_1.__importDefault(require(\"./PopupHelper\"));\n\nvar PopupPin_1 = tslib_1.__importDefault(require(\"./PopupPin\"));\n\nvar LayoutEvents_1 = tslib_1.__importDefault(require(\"../../lib/LayoutEvents\"));\n\nvar Popup_module_less_1 = tslib_1.__importDefault(require(\"./Popup.module.css\"));\n\nvar ensureOldIEClassName_1 = require(\"../ensureOldIEClassName\");\n\nvar warning_1 = tslib_1.__importDefault(require(\"warning\"));\n\nvar utils_1 = require(\"../../lib/utils\");\n\nvar LifeCycleProxy_1 = tslib_1.__importDefault(require(\"../internal/LifeCycleProxy\"));\n\nvar Emotion_1 = require(\"../../lib/theming/Emotion\");\n\nvar Popup_styles_1 = tslib_1.__importDefault(require(\"./Popup.styles\"));\n\nvar ThemeConsumer_1 = require(\"../ThemeConsumer\");\n\nvar POPUP_BORDER_DEFAULT_COLOR = 'transparent';\nvar TRANSITION_TIMEOUT = {\n  enter: 0,\n  exit: 200\n};\nvar DUMMY_LOCATION = {\n  position: 'top left',\n  coordinates: {\n    top: -9999,\n    left: -9999\n  }\n};\nexports.PopupPositions = ['top left', 'top center', 'top right', 'right top', 'right middle', 'right bottom', 'bottom right', 'bottom center', 'bottom left', 'left bottom', 'left middle', 'left top'];\n\nvar Popup =\n/** @class */\nfunction (_super) {\n  tslib_1.__extends(Popup, _super);\n\n  function Popup() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.state = {\n      location: _this.props.opened ? DUMMY_LOCATION : null\n    };\n    _this.locationUpdateId = null;\n    _this.anchorElement = null;\n\n    _this.refAnchorElement = function (instance) {\n      _this.anchorInstance = instance;\n\n      var element = _this.extractElement(instance);\n\n      _this.updateAnchorElement(element);\n\n      _this.anchorElement = element;\n    };\n\n    _this.handleMouseEnter = function (event) {\n      if (_this.props.onMouseEnter) {\n        _this.props.onMouseEnter(event);\n      }\n    };\n\n    _this.handleMouseLeave = function (event) {\n      if (_this.props.onMouseLeave) {\n        _this.props.onMouseLeave(event);\n      }\n    };\n\n    _this.handleClick = function (event) {\n      if (_this.props.onClick) {\n        _this.props.onClick(event);\n      }\n    };\n\n    _this.handleFocus = function (event) {\n      if (_this.props.onFocus) {\n        _this.props.onFocus(event);\n      }\n    };\n\n    _this.handleBlur = function (event) {\n      if (_this.props.onBlur) {\n        _this.props.onBlur(event);\n      }\n    };\n\n    _this.resetLocation = function () {\n      _this.cancelDelayedUpdateLocation();\n\n      _this.setState({\n        location: null\n      });\n    };\n\n    _this.refPopupElement = function (zIndex) {\n      if (zIndex) {\n        _this.lastPopupElement = zIndex && react_dom_1.findDOMNode(zIndex);\n      }\n    };\n\n    _this.handleLayoutEvent = function () {\n      if (!_this.state.location) {\n        return;\n      }\n\n      if (_this.anchorInstance) {\n        _this.updateAnchorElement(_this.extractElement(_this.anchorInstance));\n      }\n\n      _this.updateLocation();\n    };\n\n    _this.handleDidUpdate = function (prevProps, props) {\n      var hadNoLocation = prevProps.location === DUMMY_LOCATION;\n      var hasLocation = props.location !== DUMMY_LOCATION;\n\n      if (hadNoLocation && hasLocation && _this.props.onOpen) {\n        _this.props.onOpen();\n      }\n    };\n\n    _this.updateLocation = function () {\n      var popupElement = _this.lastPopupElement;\n\n      if (!popupElement) {\n        return;\n      }\n\n      var location = _this.getLocation(popupElement, _this.state.location);\n\n      if (!_this.locationEquals(_this.state.location, location)) {\n        _this.setState({\n          location: location\n        });\n      }\n    };\n\n    return _this;\n  }\n\n  Popup.prototype.componentDidMount = function () {\n    this.updateLocation();\n    this.layoutEventsToken = LayoutEvents_1[\"default\"].addListener(this.handleLayoutEvent);\n  };\n\n  Popup.prototype.componentWillReceiveProps = function (nextProps) {\n    /**\r\n                                                                     * For react < 16 version ReactDOM.unstable_renderSubtreeIntoContainer is\r\n                                                                     * used. It causes refs callbacks to call after componentDidUpdate.\r\n                                                                     *\r\n                                                                     * Delaying updateLocation to ensure that ref is set\r\n                                                                     */\n    if (nextProps.opened) {\n      if (!this.state.location) {\n        this.setState({\n          location: DUMMY_LOCATION\n        });\n      }\n\n      this.delayUpdateLocation();\n    }\n  };\n\n  Popup.prototype.componentWillUnmount = function () {\n    this.cancelDelayedUpdateLocation();\n    this.removeEventListeners(this.anchorElement);\n\n    if (this.layoutEventsToken) {\n      this.layoutEventsToken.remove();\n      this.layoutEventsToken = null;\n    }\n  };\n\n  Popup.prototype.render = function () {\n    var _this = this;\n\n    return React.createElement(ThemeConsumer_1.ThemeConsumer, null, function (theme) {\n      _this.theme = theme;\n      return _this.renderMain();\n    });\n  };\n\n  Popup.prototype.renderMain = function () {\n    var location = this.state.location;\n    var _a = this.props,\n        anchorElement = _a.anchorElement,\n        useWrapper = _a.useWrapper;\n    var child = null;\n\n    if (anchorElement instanceof HTMLElement) {\n      this.updateAnchorElement(anchorElement);\n    } else if (React.isValidElement(anchorElement)) {\n      child = useWrapper ? React.createElement(\"span\", null, anchorElement) : anchorElement;\n    } else {\n      child = React.createElement(\"span\", null, anchorElement);\n    }\n\n    return React.createElement(RenderContainer_1[\"default\"], {\n      anchor: child,\n      ref: child ? this.refAnchorElement : undefined\n    }, location && this.renderContent(location));\n  };\n\n  Popup.prototype.extractElement = function (instance) {\n    if (!instance) {\n      return null;\n    }\n\n    var element = react_dom_1.findDOMNode(instance);\n    return element instanceof HTMLElement ? element : null;\n  };\n\n  Popup.prototype.updateAnchorElement = function (element) {\n    var anchorElement = this.anchorElement;\n\n    if (element !== anchorElement) {\n      this.removeEventListeners(anchorElement);\n      this.anchorElement = element;\n      this.addEventListeners(element);\n    }\n  };\n\n  Popup.prototype.addEventListeners = function (element) {\n    if (element && element instanceof HTMLElement) {\n      element.addEventListener('mouseenter', this.handleMouseEnter);\n      element.addEventListener('mouseleave', this.handleMouseLeave);\n      element.addEventListener('click', this.handleClick);\n      element.addEventListener('focusin', this.handleFocus);\n      element.addEventListener('focusout', this.handleBlur);\n    }\n  };\n\n  Popup.prototype.removeEventListeners = function (element) {\n    if (element && element instanceof HTMLElement) {\n      element.removeEventListener('mouseenter', this.handleMouseEnter);\n      element.removeEventListener('mouseleave', this.handleMouseLeave);\n      element.removeEventListener('click', this.handleClick);\n      element.removeEventListener('focusin', this.handleFocus);\n      element.removeEventListener('focusout', this.handleBlur);\n    }\n  };\n\n  Popup.prototype.renderContent = function (location) {\n    var _this = this;\n\n    var _a = this.props,\n        backgroundColor = _a.backgroundColor,\n        disableAnimations = _a.disableAnimations,\n        maxWidth = _a.maxWidth,\n        hasShadow = _a.hasShadow,\n        ignoreHover = _a.ignoreHover,\n        opened = _a.opened;\n    var children = this.renderChildren();\n    var direction = PopupHelper_1[\"default\"].getPositionObject(location.position).direction;\n\n    var rootStyle = tslib_1.__assign({}, location.coordinates, {\n      maxWidth: maxWidth\n    }); // This need to correct handle order of lifecycle hooks with portal and react@15\n    // For more details see issue #1257\n\n\n    return React.createElement(LifeCycleProxy_1[\"default\"], {\n      onDidUpdate: this.handleDidUpdate,\n      props: this.state\n    }, React.createElement(react_transition_group_1.Transition, {\n      timeout: TRANSITION_TIMEOUT,\n      appear: !disableAnimations,\n      \"in\": Boolean(opened && children),\n      mountOnEnter: true,\n      unmountOnExit: true,\n      enter: !disableAnimations,\n      exit: !disableAnimations,\n      onExited: this.resetLocation\n    }, function (state) {\n      var _a, _b;\n\n      return React.createElement(ZIndex_1[\"default\"], {\n        ref: _this.refPopupElement,\n        priority: 'Popup',\n        className: Emotion_1.cx([Popup_module_less_1[\"default\"].popup, Popup_styles_1[\"default\"].popup(_this.theme)], tslib_1.__assign((_a = {}, _a[Popup_styles_1[\"default\"].shadow(_this.theme)] = hasShadow, _a[Popup_module_less_1[\"default\"]['popup-ignore-hover']] = ignoreHover, _a), disableAnimations ? {} : (_b = {}, _b[Popup_module_less_1[\"default\"]['transition-enter']] = state === 'entering', _b[Popup_module_less_1[\"default\"]['transition-enter-active']] = state === 'entered', _b[Popup_module_less_1[\"default\"]['transition-exit']] = state === 'exiting', _b[Popup_module_less_1[\"default\"][\"transition-enter-\" + direction]] = true, _b))),\n        style: rootStyle,\n        onMouseEnter: _this.handleMouseEnter,\n        onMouseLeave: _this.handleMouseLeave\n      }, React.createElement(\"div\", {\n        className: Emotion_1.cx(Popup_module_less_1[\"default\"].content, Popup_styles_1[\"default\"].content(_this.theme)),\n        \"data-tid\": 'PopupContent'\n      }, React.createElement(\"div\", {\n        className: Popup_styles_1[\"default\"].contentInner(_this.theme),\n        style: {\n          backgroundColor: backgroundColor\n        },\n        \"data-tid\": 'PopupContentInner'\n      }, children)), _this.renderPin(location.position));\n    }));\n  };\n\n  Popup.prototype.renderChildren = function () {\n    return utils_1.isFunction(this.props.children) ? this.props.children() : this.props.children;\n  };\n\n  Popup.prototype.renderPin = function (position) {\n    /**\r\n                                                    * Box-shadow does not appear under the pin. Borders are used instead.\r\n                                                    * In non-ie browsers drop-shadow filter is used. It is applying\r\n                                                    * shadow to the pin too.\r\n                                                    */\n    var isDefaultBorderColor = this.theme.popupBorderColor === POPUP_BORDER_DEFAULT_COLOR;\n    var pinBorder = ensureOldIEClassName_1.isIE && isDefaultBorderColor ? 'rgba(0, 0, 0, 0.09)' : this.theme.popupBorderColor;\n    var _a = this.props,\n        pinSize = _a.pinSize,\n        pinOffset = _a.pinOffset,\n        hasShadow = _a.hasShadow,\n        backgroundColor = _a.backgroundColor,\n        borderColor = _a.borderColor;\n    return this.props.hasPin && React.createElement(PopupPin_1[\"default\"], {\n      popupElement: this.lastPopupElement,\n      popupPosition: position,\n      size: pinSize,\n      offset: pinOffset,\n      borderWidth: hasShadow ? 1 : 0,\n      backgroundColor: backgroundColor || this.theme.popupBackground,\n      borderColor: borderColor || pinBorder\n    });\n  };\n\n  Popup.prototype.delayUpdateLocation = function () {\n    this.cancelDelayedUpdateLocation();\n    this.locationUpdateId = raf_1[\"default\"](this.updateLocation);\n  };\n\n  Popup.prototype.cancelDelayedUpdateLocation = function () {\n    if (this.locationUpdateId) {\n      raf_1[\"default\"].cancel(this.locationUpdateId);\n      this.locationUpdateId = null;\n    }\n  };\n\n  Popup.prototype.locationEquals = function (x, y) {\n    if (x === y) {\n      return true;\n    }\n\n    if (x == null || y == null) {\n      return false;\n    }\n\n    return x.coordinates.left === y.coordinates.left && x.coordinates.top === y.coordinates.top && x.position === y.position;\n  };\n\n  Popup.prototype.getLocation = function (popupElement, location) {\n    var positions = this.props.positions;\n    var anchorElement = this.anchorElement;\n    warning_1[\"default\"](anchorElement && anchorElement instanceof HTMLElement, 'Anchor element is not defined or not instance of HTMLElement');\n\n    if (!(anchorElement && anchorElement instanceof HTMLElement)) {\n      return location;\n    }\n\n    var anchorRect = PopupHelper_1[\"default\"].getElementAbsoluteRect(anchorElement);\n    var popupRect = PopupHelper_1[\"default\"].getElementAbsoluteRect(popupElement);\n    var position;\n    var coordinates;\n\n    if (location && location !== DUMMY_LOCATION && location.position) {\n      position = location.position;\n      coordinates = this.getCoordinates(anchorRect, popupRect, position);\n      var isFullyVisible = PopupHelper_1[\"default\"].isFullyVisible(coordinates, popupRect);\n      var canBecomeVisible = !isFullyVisible && PopupHelper_1[\"default\"].canBecomeFullyVisible(position, coordinates);\n\n      if (isFullyVisible || canBecomeVisible) {\n        return {\n          coordinates: coordinates,\n          position: position\n        };\n      }\n    }\n\n    for (var _i = 0, positions_1 = positions; _i < positions_1.length; _i++) {\n      position = positions_1[_i];\n      coordinates = this.getCoordinates(anchorRect, popupRect, position);\n\n      if (PopupHelper_1[\"default\"].isFullyVisible(coordinates, popupRect)) {\n        return {\n          coordinates: coordinates,\n          position: position\n        };\n      }\n    }\n\n    position = positions[0];\n    coordinates = this.getCoordinates(anchorRect, popupRect, position);\n    return {\n      coordinates: coordinates,\n      position: position\n    };\n  };\n\n  Popup.prototype.getPinnedPopupOffset = function (anchorRect, position) {\n    if (!this.props.hasPin || /center|middle/.test(position.align)) {\n      return 0;\n    }\n\n    var anchorSize = /top|bottom/.test(position.direction) ? anchorRect.width : anchorRect.height;\n    var _a = this.props,\n        pinOffset = _a.pinOffset,\n        pinSize = _a.pinSize;\n    return Math.max(0, pinOffset + pinSize - anchorSize / 2);\n  };\n\n  Popup.prototype.getCoordinates = function (anchorRect, popupRect, positionName) {\n    var margin = this.props.margin;\n    var position = PopupHelper_1[\"default\"].getPositionObject(positionName);\n    var popupOffset = this.props.popupOffset + this.getPinnedPopupOffset(anchorRect, position);\n\n    switch (position.direction) {\n      case 'top':\n        return {\n          top: anchorRect.top - popupRect.height - margin,\n          left: this.getHorizontalPosition(anchorRect, popupRect, position.align, popupOffset)\n        };\n\n      case 'bottom':\n        return {\n          top: anchorRect.top + anchorRect.height + margin,\n          left: this.getHorizontalPosition(anchorRect, popupRect, position.align, popupOffset)\n        };\n\n      case 'left':\n        return {\n          top: this.getVerticalPosition(anchorRect, popupRect, position.align, popupOffset),\n          left: anchorRect.left - popupRect.width - margin\n        };\n\n      case 'right':\n        return {\n          top: this.getVerticalPosition(anchorRect, popupRect, position.align, popupOffset),\n          left: anchorRect.left + anchorRect.width + margin\n        };\n\n      default:\n        throw new Error(\"Unxpected direction '\" + position.direction + \"'\");\n    }\n  };\n\n  Popup.prototype.getHorizontalPosition = function (anchorRect, popupRect, align, popupOffset) {\n    switch (align) {\n      case 'left':\n        return anchorRect.left - popupOffset;\n\n      case 'center':\n        return anchorRect.left - (popupRect.width - anchorRect.width) / 2;\n\n      case 'right':\n        return anchorRect.left - (popupRect.width - anchorRect.width) + popupOffset;\n\n      default:\n        throw new Error(\"Unxpected align '\" + align + \"'\");\n    }\n  };\n\n  Popup.prototype.getVerticalPosition = function (anchorRect, popupRect, align, popupOffset) {\n    switch (align) {\n      case 'top':\n        return anchorRect.top - popupOffset;\n\n      case 'middle':\n        return anchorRect.top - (popupRect.height - anchorRect.height) / 2;\n\n      case 'bottom':\n        return anchorRect.top - (popupRect.height - anchorRect.height) + popupOffset;\n\n      default:\n        throw new Error(\"Unxpected align '\" + align + \"'\");\n    }\n  };\n\n  Popup.__KONTUR_REACT_UI__ = 'Popup';\n  Popup.propTypes = {\n    /**\r\n                       * Ссылка (ref) на элемент или React компонент, для которого рисуется попап\r\n                       */\n    anchorElement: PropTypes.oneOfType([safePropTypes.instanceOf(function () {\n      return HTMLElement;\n    }), PropTypes.node]).isRequired,\n\n    /**\r\n                                                                                                                                   * Фон попапа и пина\r\n                                                                                                                                   */\n    backgroundColor: PropTypes.string,\n    children: PropTypes.oneOfType([PropTypes.node, PropTypes.func]),\n\n    /**\r\n                                                                      * Показывать ли пин\r\n                                                                      */\n    hasPin: PropTypes.bool,\n\n    /**\r\n                             * Применять ли box-shadow на попапе. При false отключает границу на пине\r\n                             */\n    hasShadow: PropTypes.bool,\n\n    /**\r\n                                * Отступ попапа от элемента\r\n                                */\n    margin: PropTypes.number,\n\n    /**\r\n                               * Показан или скрыт попап\r\n                               */\n    opened: PropTypes.bool,\n\n    /**\r\n                             * Смещение пина от края попапа. Край задаётся в пропе position вторым словом\r\n                             */\n    pinOffset: PropTypes.number,\n\n    /**\r\n                                  * Сторона пина без учёта границы.\r\n                                  * Пин представляет собой равносторонний треугольник, высота от попапа\r\n                                  * до \"носика\" пина будет соответствовать формуле (size* √3)/2\r\n                                  */\n    pinSize: PropTypes.number,\n\n    /**\r\n                                * смещение попапа относительно родительского элемента\r\n                                */\n    popupOffset: PropTypes.number,\n\n    /**\r\n                                    * С какой стороны показывать попап и край попапа,\r\n                                    * на котором будет отображаться пин\r\n                                    */\n    positions: PropTypes.array,\n\n    /**\r\n                                 * Игнорировать ли события hover/click\r\n                                 */\n    ignoreHover: PropTypes.bool\n  };\n  Popup.defaultProps = {\n    margin: 10,\n    popupOffset: 0,\n    pinSize: 8,\n    pinOffset: 16,\n    hasPin: false,\n    hasShadow: false,\n    disableAnimations: Boolean(process.env.enableReactTesting),\n    useWrapper: false,\n    ignoreHover: false\n  };\n  return Popup;\n}(React.Component);\n\nexports[\"default\"] = Popup;","map":{"version":3,"sources":["/home/aleksandr/Documents/HwProj-2.0.1/hwproj.courseworks.front/node_modules/@skbkontur/react-ui/components/Popup/Popup.js"],"names":["Object","defineProperty","exports","value","tslib_1","require","React","__importStar","react_dom_1","PropTypes","safePropTypes","RenderContainer_1","__importDefault","ZIndex_1","react_transition_group_1","raf_1","PopupHelper_1","PopupPin_1","LayoutEvents_1","Popup_module_less_1","ensureOldIEClassName_1","warning_1","utils_1","LifeCycleProxy_1","Emotion_1","Popup_styles_1","ThemeConsumer_1","POPUP_BORDER_DEFAULT_COLOR","TRANSITION_TIMEOUT","enter","exit","DUMMY_LOCATION","position","coordinates","top","left","PopupPositions","Popup","_super","__extends","_this","apply","arguments","state","location","props","opened","locationUpdateId","anchorElement","refAnchorElement","instance","anchorInstance","element","extractElement","updateAnchorElement","handleMouseEnter","event","onMouseEnter","handleMouseLeave","onMouseLeave","handleClick","onClick","handleFocus","onFocus","handleBlur","onBlur","resetLocation","cancelDelayedUpdateLocation","setState","refPopupElement","zIndex","lastPopupElement","findDOMNode","handleLayoutEvent","updateLocation","handleDidUpdate","prevProps","hadNoLocation","hasLocation","onOpen","popupElement","getLocation","locationEquals","prototype","componentDidMount","layoutEventsToken","addListener","componentWillReceiveProps","nextProps","delayUpdateLocation","componentWillUnmount","removeEventListeners","remove","render","createElement","ThemeConsumer","theme","renderMain","_a","useWrapper","child","HTMLElement","isValidElement","anchor","ref","undefined","renderContent","addEventListeners","addEventListener","removeEventListener","backgroundColor","disableAnimations","maxWidth","hasShadow","ignoreHover","children","renderChildren","direction","getPositionObject","rootStyle","__assign","onDidUpdate","Transition","timeout","appear","Boolean","mountOnEnter","unmountOnExit","onExited","_b","priority","className","cx","popup","shadow","style","content","contentInner","renderPin","isFunction","isDefaultBorderColor","popupBorderColor","pinBorder","isIE","pinSize","pinOffset","borderColor","hasPin","popupPosition","size","offset","borderWidth","popupBackground","cancel","x","y","positions","anchorRect","getElementAbsoluteRect","popupRect","getCoordinates","isFullyVisible","canBecomeVisible","canBecomeFullyVisible","_i","positions_1","length","getPinnedPopupOffset","test","align","anchorSize","width","height","Math","max","positionName","margin","popupOffset","getHorizontalPosition","getVerticalPosition","Error","__KONTUR_REACT_UI__","propTypes","oneOfType","instanceOf","node","isRequired","string","func","bool","number","array","defaultProps","process","env","enableReactTesting","Component"],"mappings":"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","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar tslib_1 = require(\"tslib\");\nvar React = tslib_1.__importStar(require(\"react\"));\nvar react_dom_1 = require(\"react-dom\");\nvar PropTypes = tslib_1.__importStar(require(\"prop-types\"));\nvar safePropTypes = tslib_1.__importStar(require(\"../../lib/SSRSafePropTypes\"));\nvar RenderContainer_1 = tslib_1.__importDefault(require(\"../RenderContainer\"));\nvar ZIndex_1 = tslib_1.__importDefault(require(\"../ZIndex\"));\nvar react_transition_group_1 = require(\"react-transition-group\");\nvar raf_1 = tslib_1.__importDefault(require(\"raf\"));\nvar PopupHelper_1 = tslib_1.__importDefault(require(\"./PopupHelper\"));\nvar PopupPin_1 = tslib_1.__importDefault(require(\"./PopupPin\"));\nvar LayoutEvents_1 = tslib_1.__importDefault(require(\"../../lib/LayoutEvents\"));\nvar Popup_module_less_1 = tslib_1.__importDefault(require(\"./Popup.module.css\"));\nvar ensureOldIEClassName_1 = require(\"../ensureOldIEClassName\");\nvar warning_1 = tslib_1.__importDefault(require(\"warning\"));\nvar utils_1 = require(\"../../lib/utils\");\nvar LifeCycleProxy_1 = tslib_1.__importDefault(require(\"../internal/LifeCycleProxy\"));\nvar Emotion_1 = require(\"../../lib/theming/Emotion\");\nvar Popup_styles_1 = tslib_1.__importDefault(require(\"./Popup.styles\"));\nvar ThemeConsumer_1 = require(\"../ThemeConsumer\");\nvar POPUP_BORDER_DEFAULT_COLOR = 'transparent';\nvar TRANSITION_TIMEOUT = { enter: 0, exit: 200 };\nvar DUMMY_LOCATION = {\n  position: 'top left',\n  coordinates: {\n    top: -9999,\n    left: -9999 } };\n\n\nexports.PopupPositions = [\n'top left',\n'top center',\n'top right',\n'right top',\n'right middle',\n'right bottom',\n'bottom right',\n'bottom center',\n'bottom left',\n'left bottom',\n'left middle',\n'left top'];\n\nvar Popup = /** @class */function (_super) {\n  tslib_1.__extends(Popup, _super);\n  function Popup() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n    _this.state = { location: _this.props.opened ? DUMMY_LOCATION : null };\n    _this.locationUpdateId = null;\n    _this.anchorElement = null;\n    _this.refAnchorElement = function (instance) {\n      _this.anchorInstance = instance;\n      var element = _this.extractElement(instance);\n      _this.updateAnchorElement(element);\n      _this.anchorElement = element;\n    };\n    _this.handleMouseEnter = function (event) {\n      if (_this.props.onMouseEnter) {\n        _this.props.onMouseEnter(event);\n      }\n    };\n    _this.handleMouseLeave = function (event) {\n      if (_this.props.onMouseLeave) {\n        _this.props.onMouseLeave(event);\n      }\n    };\n    _this.handleClick = function (event) {\n      if (_this.props.onClick) {\n        _this.props.onClick(event);\n      }\n    };\n    _this.handleFocus = function (event) {\n      if (_this.props.onFocus) {\n        _this.props.onFocus(event);\n      }\n    };\n    _this.handleBlur = function (event) {\n      if (_this.props.onBlur) {\n        _this.props.onBlur(event);\n      }\n    };\n    _this.resetLocation = function () {\n      _this.cancelDelayedUpdateLocation();\n      _this.setState({ location: null });\n    };\n    _this.refPopupElement = function (zIndex) {\n      if (zIndex) {\n        _this.lastPopupElement = zIndex && react_dom_1.findDOMNode(zIndex);\n      }\n    };\n    _this.handleLayoutEvent = function () {\n      if (!_this.state.location) {\n        return;\n      }\n      if (_this.anchorInstance) {\n        _this.updateAnchorElement(_this.extractElement(_this.anchorInstance));\n      }\n      _this.updateLocation();\n    };\n    _this.handleDidUpdate = function (prevProps, props) {\n      var hadNoLocation = prevProps.location === DUMMY_LOCATION;\n      var hasLocation = props.location !== DUMMY_LOCATION;\n      if (hadNoLocation && hasLocation && _this.props.onOpen) {\n        _this.props.onOpen();\n      }\n    };\n    _this.updateLocation = function () {\n      var popupElement = _this.lastPopupElement;\n      if (!popupElement) {\n        return;\n      }\n      var location = _this.getLocation(popupElement, _this.state.location);\n      if (!_this.locationEquals(_this.state.location, location)) {\n        _this.setState({ location: location });\n      }\n    };\n    return _this;\n  }\n  Popup.prototype.componentDidMount = function () {\n    this.updateLocation();\n    this.layoutEventsToken = LayoutEvents_1[\"default\"].addListener(this.handleLayoutEvent);\n  };\n  Popup.prototype.componentWillReceiveProps = function (nextProps) {\n    /**\r\n                                                                     * For react < 16 version ReactDOM.unstable_renderSubtreeIntoContainer is\r\n                                                                     * used. It causes refs callbacks to call after componentDidUpdate.\r\n                                                                     *\r\n                                                                     * Delaying updateLocation to ensure that ref is set\r\n                                                                     */\n    if (nextProps.opened) {\n      if (!this.state.location) {\n        this.setState({ location: DUMMY_LOCATION });\n      }\n      this.delayUpdateLocation();\n    }\n  };\n  Popup.prototype.componentWillUnmount = function () {\n    this.cancelDelayedUpdateLocation();\n    this.removeEventListeners(this.anchorElement);\n    if (this.layoutEventsToken) {\n      this.layoutEventsToken.remove();\n      this.layoutEventsToken = null;\n    }\n  };\n  Popup.prototype.render = function () {\n    var _this = this;\n    return React.createElement(ThemeConsumer_1.ThemeConsumer, null, function (theme) {\n      _this.theme = theme;\n      return _this.renderMain();\n    });\n  };\n  Popup.prototype.renderMain = function () {\n    var location = this.state.location;\n    var _a = this.props,anchorElement = _a.anchorElement,useWrapper = _a.useWrapper;\n    var child = null;\n    if (anchorElement instanceof HTMLElement) {\n      this.updateAnchorElement(anchorElement);\n    } else\n    if (React.isValidElement(anchorElement)) {\n      child = useWrapper ? React.createElement(\"span\", null, anchorElement) : anchorElement;\n    } else\n    {\n      child = React.createElement(\"span\", null, anchorElement);\n    }\n    return React.createElement(RenderContainer_1[\"default\"], { anchor: child, ref: child ? this.refAnchorElement : undefined }, location && this.renderContent(location));\n  };\n  Popup.prototype.extractElement = function (instance) {\n    if (!instance) {\n      return null;\n    }\n    var element = react_dom_1.findDOMNode(instance);\n    return element instanceof HTMLElement ? element : null;\n  };\n  Popup.prototype.updateAnchorElement = function (element) {\n    var anchorElement = this.anchorElement;\n    if (element !== anchorElement) {\n      this.removeEventListeners(anchorElement);\n      this.anchorElement = element;\n      this.addEventListeners(element);\n    }\n  };\n  Popup.prototype.addEventListeners = function (element) {\n    if (element && element instanceof HTMLElement) {\n      element.addEventListener('mouseenter', this.handleMouseEnter);\n      element.addEventListener('mouseleave', this.handleMouseLeave);\n      element.addEventListener('click', this.handleClick);\n      element.addEventListener('focusin', this.handleFocus);\n      element.addEventListener('focusout', this.handleBlur);\n    }\n  };\n  Popup.prototype.removeEventListeners = function (element) {\n    if (element && element instanceof HTMLElement) {\n      element.removeEventListener('mouseenter', this.handleMouseEnter);\n      element.removeEventListener('mouseleave', this.handleMouseLeave);\n      element.removeEventListener('click', this.handleClick);\n      element.removeEventListener('focusin', this.handleFocus);\n      element.removeEventListener('focusout', this.handleBlur);\n    }\n  };\n  Popup.prototype.renderContent = function (location) {\n    var _this = this;\n    var _a = this.props,backgroundColor = _a.backgroundColor,disableAnimations = _a.disableAnimations,maxWidth = _a.maxWidth,hasShadow = _a.hasShadow,ignoreHover = _a.ignoreHover,opened = _a.opened;\n    var children = this.renderChildren();\n    var direction = PopupHelper_1[\"default\"].getPositionObject(location.position).direction;\n    var rootStyle = tslib_1.__assign({}, location.coordinates, { maxWidth: maxWidth });\n    // This need to correct handle order of lifecycle hooks with portal and react@15\n    // For more details see issue #1257\n    return React.createElement(LifeCycleProxy_1[\"default\"], { onDidUpdate: this.handleDidUpdate, props: this.state },\n    React.createElement(react_transition_group_1.Transition, { timeout: TRANSITION_TIMEOUT, appear: !disableAnimations, \"in\": Boolean(opened && children), mountOnEnter: true, unmountOnExit: true, enter: !disableAnimations, exit: !disableAnimations, onExited: this.resetLocation }, function (state) {\n      var _a, _b;\n      return React.createElement(ZIndex_1[\"default\"], { ref: _this.refPopupElement, priority: 'Popup', className: Emotion_1.cx([Popup_module_less_1[\"default\"].popup, Popup_styles_1[\"default\"].popup(_this.theme)], tslib_1.__assign((_a = {}, _a[Popup_styles_1[\"default\"].shadow(_this.theme)] = hasShadow, _a[Popup_module_less_1[\"default\"]['popup-ignore-hover']] = ignoreHover, _a), disableAnimations ?\n        {} : (\n        _b = {},\n        _b[Popup_module_less_1[\"default\"]['transition-enter']] = state === 'entering',\n        _b[Popup_module_less_1[\"default\"]['transition-enter-active']] = state === 'entered',\n        _b[Popup_module_less_1[\"default\"]['transition-exit']] = state === 'exiting',\n        _b[Popup_module_less_1[\"default\"][\"transition-enter-\" + direction]] = true,\n        _b))), style: rootStyle, onMouseEnter: _this.handleMouseEnter, onMouseLeave: _this.handleMouseLeave },\n      React.createElement(\"div\", { className: Emotion_1.cx(Popup_module_less_1[\"default\"].content, Popup_styles_1[\"default\"].content(_this.theme)), \"data-tid\": 'PopupContent' },\n      React.createElement(\"div\", { className: Popup_styles_1[\"default\"].contentInner(_this.theme), style: { backgroundColor: backgroundColor }, \"data-tid\": 'PopupContentInner' }, children)),\n      _this.renderPin(location.position));\n    }));\n  };\n  Popup.prototype.renderChildren = function () {\n    return utils_1.isFunction(this.props.children) ? this.props.children() : this.props.children;\n  };\n  Popup.prototype.renderPin = function (position) {\n    /**\r\n                                                    * Box-shadow does not appear under the pin. Borders are used instead.\r\n                                                    * In non-ie browsers drop-shadow filter is used. It is applying\r\n                                                    * shadow to the pin too.\r\n                                                    */\n    var isDefaultBorderColor = this.theme.popupBorderColor === POPUP_BORDER_DEFAULT_COLOR;\n    var pinBorder = ensureOldIEClassName_1.isIE && isDefaultBorderColor ? 'rgba(0, 0, 0, 0.09)' : this.theme.popupBorderColor;\n    var _a = this.props,pinSize = _a.pinSize,pinOffset = _a.pinOffset,hasShadow = _a.hasShadow,backgroundColor = _a.backgroundColor,borderColor = _a.borderColor;\n    return this.props.hasPin && React.createElement(PopupPin_1[\"default\"], { popupElement: this.lastPopupElement, popupPosition: position, size: pinSize, offset: pinOffset, borderWidth: hasShadow ? 1 : 0, backgroundColor: backgroundColor || this.theme.popupBackground, borderColor: borderColor || pinBorder });\n  };\n  Popup.prototype.delayUpdateLocation = function () {\n    this.cancelDelayedUpdateLocation();\n    this.locationUpdateId = raf_1[\"default\"](this.updateLocation);\n  };\n  Popup.prototype.cancelDelayedUpdateLocation = function () {\n    if (this.locationUpdateId) {\n      raf_1[\"default\"].cancel(this.locationUpdateId);\n      this.locationUpdateId = null;\n    }\n  };\n  Popup.prototype.locationEquals = function (x, y) {\n    if (x === y) {\n      return true;\n    }\n    if (x == null || y == null) {\n      return false;\n    }\n    return x.coordinates.left === y.coordinates.left && x.coordinates.top === y.coordinates.top && x.position === y.position;\n  };\n  Popup.prototype.getLocation = function (popupElement, location) {\n    var positions = this.props.positions;\n    var anchorElement = this.anchorElement;\n    warning_1[\"default\"](anchorElement && anchorElement instanceof HTMLElement, 'Anchor element is not defined or not instance of HTMLElement');\n    if (!(anchorElement && anchorElement instanceof HTMLElement)) {\n      return location;\n    }\n    var anchorRect = PopupHelper_1[\"default\"].getElementAbsoluteRect(anchorElement);\n    var popupRect = PopupHelper_1[\"default\"].getElementAbsoluteRect(popupElement);\n    var position;\n    var coordinates;\n    if (location && location !== DUMMY_LOCATION && location.position) {\n      position = location.position;\n      coordinates = this.getCoordinates(anchorRect, popupRect, position);\n      var isFullyVisible = PopupHelper_1[\"default\"].isFullyVisible(coordinates, popupRect);\n      var canBecomeVisible = !isFullyVisible && PopupHelper_1[\"default\"].canBecomeFullyVisible(position, coordinates);\n      if (isFullyVisible || canBecomeVisible) {\n        return { coordinates: coordinates, position: position };\n      }\n    }\n    for (var _i = 0, positions_1 = positions; _i < positions_1.length; _i++) {\n      position = positions_1[_i];\n      coordinates = this.getCoordinates(anchorRect, popupRect, position);\n      if (PopupHelper_1[\"default\"].isFullyVisible(coordinates, popupRect)) {\n        return { coordinates: coordinates, position: position };\n      }\n    }\n    position = positions[0];\n    coordinates = this.getCoordinates(anchorRect, popupRect, position);\n    return { coordinates: coordinates, position: position };\n  };\n  Popup.prototype.getPinnedPopupOffset = function (anchorRect, position) {\n    if (!this.props.hasPin || /center|middle/.test(position.align)) {\n      return 0;\n    }\n    var anchorSize = /top|bottom/.test(position.direction) ? anchorRect.width : anchorRect.height;\n    var _a = this.props,pinOffset = _a.pinOffset,pinSize = _a.pinSize;\n    return Math.max(0, pinOffset + pinSize - anchorSize / 2);\n  };\n  Popup.prototype.getCoordinates = function (anchorRect, popupRect, positionName) {\n    var margin = this.props.margin;\n    var position = PopupHelper_1[\"default\"].getPositionObject(positionName);\n    var popupOffset = this.props.popupOffset + this.getPinnedPopupOffset(anchorRect, position);\n    switch (position.direction) {\n      case 'top':\n        return {\n          top: anchorRect.top - popupRect.height - margin,\n          left: this.getHorizontalPosition(anchorRect, popupRect, position.align, popupOffset) };\n\n      case 'bottom':\n        return {\n          top: anchorRect.top + anchorRect.height + margin,\n          left: this.getHorizontalPosition(anchorRect, popupRect, position.align, popupOffset) };\n\n      case 'left':\n        return {\n          top: this.getVerticalPosition(anchorRect, popupRect, position.align, popupOffset),\n          left: anchorRect.left - popupRect.width - margin };\n\n      case 'right':\n        return {\n          top: this.getVerticalPosition(anchorRect, popupRect, position.align, popupOffset),\n          left: anchorRect.left + anchorRect.width + margin };\n\n      default:\n        throw new Error(\"Unxpected direction '\" + position.direction + \"'\");}\n\n  };\n  Popup.prototype.getHorizontalPosition = function (anchorRect, popupRect, align, popupOffset) {\n    switch (align) {\n      case 'left':\n        return anchorRect.left - popupOffset;\n      case 'center':\n        return anchorRect.left - (popupRect.width - anchorRect.width) / 2;\n      case 'right':\n        return anchorRect.left - (popupRect.width - anchorRect.width) + popupOffset;\n      default:\n        throw new Error(\"Unxpected align '\" + align + \"'\");}\n\n  };\n  Popup.prototype.getVerticalPosition = function (anchorRect, popupRect, align, popupOffset) {\n    switch (align) {\n      case 'top':\n        return anchorRect.top - popupOffset;\n      case 'middle':\n        return anchorRect.top - (popupRect.height - anchorRect.height) / 2;\n      case 'bottom':\n        return anchorRect.top - (popupRect.height - anchorRect.height) + popupOffset;\n      default:\n        throw new Error(\"Unxpected align '\" + align + \"'\");}\n\n  };\n  Popup.__KONTUR_REACT_UI__ = 'Popup';\n  Popup.propTypes = {\n    /**\r\n                       * Ссылка (ref) на элемент или React компонент, для которого рисуется попап\r\n                       */\n    anchorElement: PropTypes.oneOfType([safePropTypes.instanceOf(function () {return HTMLElement;}), PropTypes.node]).isRequired,\n    /**\r\n                                                                                                                                   * Фон попапа и пина\r\n                                                                                                                                   */\n    backgroundColor: PropTypes.string,\n    children: PropTypes.oneOfType([PropTypes.node, PropTypes.func]),\n    /**\r\n                                                                      * Показывать ли пин\r\n                                                                      */\n    hasPin: PropTypes.bool,\n    /**\r\n                             * Применять ли box-shadow на попапе. При false отключает границу на пине\r\n                             */\n    hasShadow: PropTypes.bool,\n    /**\r\n                                * Отступ попапа от элемента\r\n                                */\n    margin: PropTypes.number,\n    /**\r\n                               * Показан или скрыт попап\r\n                               */\n    opened: PropTypes.bool,\n    /**\r\n                             * Смещение пина от края попапа. Край задаётся в пропе position вторым словом\r\n                             */\n    pinOffset: PropTypes.number,\n    /**\r\n                                  * Сторона пина без учёта границы.\r\n                                  * Пин представляет собой равносторонний треугольник, высота от попапа\r\n                                  * до \"носика\" пина будет соответствовать формуле (size* √3)/2\r\n                                  */\n    pinSize: PropTypes.number,\n    /**\r\n                                * смещение попапа относительно родительского элемента\r\n                                */\n    popupOffset: PropTypes.number,\n    /**\r\n                                    * С какой стороны показывать попап и край попапа,\r\n                                    * на котором будет отображаться пин\r\n                                    */\n    positions: PropTypes.array,\n    /**\r\n                                 * Игнорировать ли события hover/click\r\n                                 */\n    ignoreHover: PropTypes.bool };\n\n  Popup.defaultProps = {\n    margin: 10,\n    popupOffset: 0,\n    pinSize: 8,\n    pinOffset: 16,\n    hasPin: false,\n    hasShadow: false,\n    disableAnimations: Boolean(process.env.enableReactTesting),\n    useWrapper: false,\n    ignoreHover: false };\n\n  return Popup;\n}(React.Component);\nexports[\"default\"] = Popup;"]},"metadata":{},"sourceType":"script"}