{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar tslib_1 = require(\"tslib\");\n\nvar React = tslib_1.__importStar(require(\"react\"));\n\nvar react_dom_1 = require(\"react-dom\");\n\nvar LayoutEvents_1 = tslib_1.__importDefault(require(\"../../lib/LayoutEvents\"));\n\nvar getComputedStyle_1 = tslib_1.__importDefault(require(\"../../lib/dom/getComputedStyle\"));\n\nvar RenderContainer_1 = tslib_1.__importDefault(require(\"../RenderContainer/RenderContainer\"));\n\nvar ZIndex_1 = tslib_1.__importDefault(require(\"../ZIndex\"));\n\nvar createPropsGetter_1 = require(\"../internal/createPropsGetter\");\n\nvar DropdownContainer =\n/** @class */\nfunction (_super) {\n  tslib_1.__extends(DropdownContainer, _super);\n\n  function DropdownContainer() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.state = {\n      position: null,\n      minWidth: 0,\n      isDocumentElementRoot: true\n    };\n    _this.getProps = createPropsGetter_1.createPropsGetter(DropdownContainer.defaultProps);\n    _this.dom = null;\n\n    _this.ref = function (e) {\n      _this.dom = e && react_dom_1.findDOMNode(e);\n    };\n\n    _this.isElement = function (node) {\n      return node instanceof Element;\n    };\n\n    _this.position = function () {\n      var target = _this.props.getParent();\n\n      var dom = _this.dom;\n\n      if (_this.isElement(target) && dom) {\n        var targetRect = target.getBoundingClientRect();\n        var body = document.body,\n            docEl = document.documentElement;\n\n        if (!docEl) {\n          throw Error('There is no \"documentElement\" in \"document\"');\n        }\n\n        var scrollX_1 = window.pageXOffset || docEl.scrollLeft || 0;\n        var scrollY_1 = window.pageYOffset || docEl.scrollTop || 0;\n        var left = null;\n        var right = null;\n\n        if (_this.props.align === 'right') {\n          var docWidth = docEl.offsetWidth || 0;\n          right = docWidth - (targetRect.right + scrollX_1) + _this.getProps().offsetX;\n        } else {\n          left = targetRect.left + scrollX_1 + _this.getProps().offsetX;\n        }\n\n        var _a = _this.props.offsetY,\n            offsetY = _a === void 0 ? 0 : _a;\n        var bottom = null;\n        var top_1 = targetRect.bottom + scrollY_1 + offsetY;\n        var distanceToBottom = docEl.clientHeight - targetRect.bottom;\n\n        var dropdownHeight = _this.getHeight();\n\n        if (distanceToBottom < dropdownHeight && targetRect.top > dropdownHeight) {\n          var clientHeight = _this.state.isDocumentElementRoot ? docEl.clientHeight : body.scrollHeight;\n          top_1 = null;\n          bottom = clientHeight + offsetY - scrollY_1 - targetRect.top;\n        }\n\n        var position = {\n          top: top_1,\n          left: left,\n          right: right,\n          bottom: bottom\n        };\n\n        _this.setState({\n          minWidth: _this.getMinWidth(),\n          position: _this.props.disablePortal ? _this.convertToRelativePosition(position) : position\n        });\n      }\n    };\n\n    _this.getHeight = function () {\n      if (!_this.isElement(_this.dom)) {\n        return 0;\n      }\n\n      var child = _this.dom.children.item(0);\n\n      if (!child) {\n        return 0;\n      }\n\n      return child.getBoundingClientRect().height;\n    };\n\n    _this.getMinWidth = function () {\n      var target = _this.props.getParent();\n\n      if (!_this.isElement(target)) {\n        return 0;\n      }\n\n      return target.getBoundingClientRect().width;\n    };\n\n    _this.convertToRelativePosition = function (position) {\n      var target = _this.props.getParent();\n\n      var _a = _this.props,\n          _b = _a.offsetX,\n          offsetX = _b === void 0 ? 0 : _b,\n          _c = _a.offsetY,\n          offsetY = _c === void 0 ? 0 : _c;\n      var top = position.top,\n          bottom = position.bottom,\n          left = position.left,\n          right = position.right;\n\n      if (_this.isElement(target)) {\n        var targetHeight = target.getBoundingClientRect().height;\n        return {\n          top: top !== null ? targetHeight + offsetY : null,\n          bottom: bottom !== null ? targetHeight + offsetY : null,\n          left: left !== null ? offsetX : null,\n          right: right !== null ? offsetX : null\n        };\n      }\n\n      return {\n        top: offsetY,\n        bottom: null,\n        left: offsetX,\n        right: null\n      };\n    };\n\n    return _this;\n  }\n\n  DropdownContainer.prototype.componentDidMount = function () {\n    this.position();\n    this.layoutSub = LayoutEvents_1[\"default\"].addListener(this.position);\n  };\n\n  DropdownContainer.prototype.componentWillMount = function () {\n    var body = document.body,\n        docEl = document.documentElement;\n    var htmlPosition = getComputedStyle_1[\"default\"](docEl).position;\n    var bodyPosition = getComputedStyle_1[\"default\"](body).position;\n    var hasLimitedHeightRoot = body.scrollHeight > body.clientHeight;\n    var hasStaticRoot = htmlPosition === 'static' && bodyPosition === 'static';\n    this.setState({\n      isDocumentElementRoot: hasLimitedHeightRoot || hasStaticRoot\n    });\n  };\n\n  DropdownContainer.prototype.componentWillUnmount = function () {\n    if (this.layoutSub) {\n      this.layoutSub.remove();\n    }\n  };\n\n  DropdownContainer.prototype.render = function () {\n    var style = {\n      position: 'absolute',\n      top: '0'\n    };\n\n    if (this.state.position) {\n      var _a = this.state.position,\n          top_2 = _a.top,\n          bottom = _a.bottom,\n          left = _a.left,\n          right = _a.right;\n      style = tslib_1.__assign({}, style, {\n        top: top_2 !== null ? top_2 : undefined,\n        bottom: bottom !== null ? bottom : undefined,\n        left: left !== null ? left : undefined,\n        right: right !== null ? right : undefined,\n        minWidth: this.state.minWidth\n      });\n    }\n\n    var content = React.createElement(ZIndex_1[\"default\"], {\n      priority: 'DropdownContainer',\n      ref: this.ref,\n      style: style\n    }, this.props.children);\n    return this.props.disablePortal ? content : React.createElement(RenderContainer_1[\"default\"], null, content);\n  };\n\n  DropdownContainer.__KONTUR_REACT_UI__ = 'DropdownContainer';\n  DropdownContainer.defaultProps = {\n    align: 'left',\n    disablePortal: false,\n    offsetX: 0,\n    offsetY: -1\n  };\n  return DropdownContainer;\n}(React.Component);\n\nexports[\"default\"] = DropdownContainer;","map":{"version":3,"sources":["C:/Users/Sasha/Documents/coursework.front/node_modules/@skbkontur/react-ui/components/DropdownContainer/DropdownContainer.js"],"names":["Object","defineProperty","exports","value","tslib_1","require","React","__importStar","react_dom_1","LayoutEvents_1","__importDefault","getComputedStyle_1","RenderContainer_1","ZIndex_1","createPropsGetter_1","DropdownContainer","_super","__extends","_this","apply","arguments","state","position","minWidth","isDocumentElementRoot","getProps","createPropsGetter","defaultProps","dom","ref","e","findDOMNode","isElement","node","Element","target","props","getParent","targetRect","getBoundingClientRect","body","document","docEl","documentElement","Error","scrollX_1","window","pageXOffset","scrollLeft","scrollY_1","pageYOffset","scrollTop","left","right","align","docWidth","offsetWidth","offsetX","_a","offsetY","bottom","top_1","distanceToBottom","clientHeight","dropdownHeight","getHeight","top","scrollHeight","setState","getMinWidth","disablePortal","convertToRelativePosition","child","children","item","height","width","_b","_c","targetHeight","prototype","componentDidMount","layoutSub","addListener","componentWillMount","htmlPosition","bodyPosition","hasLimitedHeightRoot","hasStaticRoot","componentWillUnmount","remove","render","style","top_2","__assign","undefined","content","createElement","priority","__KONTUR_REACT_UI__","Component"],"mappings":"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","sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar tslib_1 = require(\"tslib\");\r\nvar React = tslib_1.__importStar(require(\"react\"));\r\nvar react_dom_1 = require(\"react-dom\");\r\nvar LayoutEvents_1 = tslib_1.__importDefault(require(\"../../lib/LayoutEvents\"));\r\nvar getComputedStyle_1 = tslib_1.__importDefault(require(\"../../lib/dom/getComputedStyle\"));\r\nvar RenderContainer_1 = tslib_1.__importDefault(require(\"../RenderContainer/RenderContainer\"));\r\nvar ZIndex_1 = tslib_1.__importDefault(require(\"../ZIndex\"));\r\nvar createPropsGetter_1 = require(\"../internal/createPropsGetter\");\r\nvar DropdownContainer = /** @class */function (_super) {\r\n  tslib_1.__extends(DropdownContainer, _super);\r\n  function DropdownContainer() {\r\n    var _this = _super !== null && _super.apply(this, arguments) || this;\r\n    _this.state = {\r\n      position: null,\r\n      minWidth: 0,\r\n      isDocumentElementRoot: true };\r\n\r\n    _this.getProps = createPropsGetter_1.createPropsGetter(DropdownContainer.defaultProps);\r\n    _this.dom = null;\r\n    _this.ref = function (e) {\r\n      _this.dom = e && react_dom_1.findDOMNode(e);\r\n    };\r\n    _this.isElement = function (node) {\r\n      return node instanceof Element;\r\n    };\r\n    _this.position = function () {\r\n      var target = _this.props.getParent();\r\n      var dom = _this.dom;\r\n      if (_this.isElement(target) && dom) {\r\n        var targetRect = target.getBoundingClientRect();\r\n        var body = document.body,docEl = document.documentElement;\r\n        if (!docEl) {\r\n          throw Error('There is no \"documentElement\" in \"document\"');\r\n        }\r\n        var scrollX_1 = window.pageXOffset || docEl.scrollLeft || 0;\r\n        var scrollY_1 = window.pageYOffset || docEl.scrollTop || 0;\r\n        var left = null;\r\n        var right = null;\r\n        if (_this.props.align === 'right') {\r\n          var docWidth = docEl.offsetWidth || 0;\r\n          right = docWidth - (targetRect.right + scrollX_1) + _this.getProps().offsetX;\r\n        } else\r\n        {\r\n          left = targetRect.left + scrollX_1 + _this.getProps().offsetX;\r\n        }\r\n        var _a = _this.props.offsetY,offsetY = _a === void 0 ? 0 : _a;\r\n        var bottom = null;\r\n        var top_1 = targetRect.bottom + scrollY_1 + offsetY;\r\n        var distanceToBottom = docEl.clientHeight - targetRect.bottom;\r\n        var dropdownHeight = _this.getHeight();\r\n        if (distanceToBottom < dropdownHeight && targetRect.top > dropdownHeight) {\r\n          var clientHeight = _this.state.isDocumentElementRoot ? docEl.clientHeight : body.scrollHeight;\r\n          top_1 = null;\r\n          bottom = clientHeight + offsetY - scrollY_1 - targetRect.top;\r\n        }\r\n        var position = {\r\n          top: top_1,\r\n          left: left,\r\n          right: right,\r\n          bottom: bottom };\r\n\r\n        _this.setState({\r\n          minWidth: _this.getMinWidth(),\r\n          position: _this.props.disablePortal ? _this.convertToRelativePosition(position) : position });\r\n\r\n      }\r\n    };\r\n    _this.getHeight = function () {\r\n      if (!_this.isElement(_this.dom)) {\r\n        return 0;\r\n      }\r\n      var child = _this.dom.children.item(0);\r\n      if (!child) {\r\n        return 0;\r\n      }\r\n      return child.getBoundingClientRect().height;\r\n    };\r\n    _this.getMinWidth = function () {\r\n      var target = _this.props.getParent();\r\n      if (!_this.isElement(target)) {\r\n        return 0;\r\n      }\r\n      return target.getBoundingClientRect().width;\r\n    };\r\n    _this.convertToRelativePosition = function (position) {\r\n      var target = _this.props.getParent();\r\n      var _a = _this.props,_b = _a.offsetX,offsetX = _b === void 0 ? 0 : _b,_c = _a.offsetY,offsetY = _c === void 0 ? 0 : _c;\r\n      var top = position.top,bottom = position.bottom,left = position.left,right = position.right;\r\n      if (_this.isElement(target)) {\r\n        var targetHeight = target.getBoundingClientRect().height;\r\n        return {\r\n          top: top !== null ? targetHeight + offsetY : null,\r\n          bottom: bottom !== null ? targetHeight + offsetY : null,\r\n          left: left !== null ? offsetX : null,\r\n          right: right !== null ? offsetX : null };\r\n\r\n      }\r\n      return {\r\n        top: offsetY,\r\n        bottom: null,\r\n        left: offsetX,\r\n        right: null };\r\n\r\n    };\r\n    return _this;\r\n  }\r\n  DropdownContainer.prototype.componentDidMount = function () {\r\n    this.position();\r\n    this.layoutSub = LayoutEvents_1[\"default\"].addListener(this.position);\r\n  };\r\n  DropdownContainer.prototype.componentWillMount = function () {\r\n    var body = document.body,docEl = document.documentElement;\r\n    var htmlPosition = getComputedStyle_1[\"default\"](docEl).position;\r\n    var bodyPosition = getComputedStyle_1[\"default\"](body).position;\r\n    var hasLimitedHeightRoot = body.scrollHeight > body.clientHeight;\r\n    var hasStaticRoot = htmlPosition === 'static' && bodyPosition === 'static';\r\n    this.setState({ isDocumentElementRoot: hasLimitedHeightRoot || hasStaticRoot });\r\n  };\r\n  DropdownContainer.prototype.componentWillUnmount = function () {\r\n    if (this.layoutSub) {\r\n      this.layoutSub.remove();\r\n    }\r\n  };\r\n  DropdownContainer.prototype.render = function () {\r\n    var style = {\r\n      position: 'absolute',\r\n      top: '0' };\r\n\r\n    if (this.state.position) {\r\n      var _a = this.state.position,top_2 = _a.top,bottom = _a.bottom,left = _a.left,right = _a.right;\r\n      style = tslib_1.__assign({}, style, { top: top_2 !== null ? top_2 : undefined, bottom: bottom !== null ? bottom : undefined, left: left !== null ? left : undefined, right: right !== null ? right : undefined, minWidth: this.state.minWidth });\r\n    }\r\n    var content = React.createElement(ZIndex_1[\"default\"], { priority: 'DropdownContainer', ref: this.ref, style: style }, this.props.children);\r\n    return this.props.disablePortal ? content : React.createElement(RenderContainer_1[\"default\"], null, content);\r\n  };\r\n  DropdownContainer.__KONTUR_REACT_UI__ = 'DropdownContainer';\r\n  DropdownContainer.defaultProps = {\r\n    align: 'left',\r\n    disablePortal: false,\r\n    offsetX: 0,\r\n    offsetY: -1 };\r\n\r\n  return DropdownContainer;\r\n}(React.Component);\r\nexports[\"default\"] = DropdownContainer;"]},"metadata":{},"sourceType":"script"}